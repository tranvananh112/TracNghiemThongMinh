<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>QuizTva Studio - H·ªá Th·ªëng Tr·∫Øc Nghi·ªám Th√¥ng Minh</title>
    <link rel="icon" type="image/png"
        href="https://anhtran.id.vn/wp-content/uploads/2025/09/cropped-Generated-Image-September-18-2025-8_04PM-1.png">

    <!-- ü¶åüéÖ PRELOAD GIFS WITH HIGH PRIORITY FOR INSTANT LOADING -->
    <link rel="preload" href="assets/images/h∆∞u nh·∫£y.gif" as="image" fetchpriority="high">
    <link rel="preload" href="assets/images/√¥ng gi√† noel.gif" as="image" fetchpriority="high">

    <!-- Preload script ƒë·ªÉ load GIFs ngay l·∫≠p t·ª©c -->
    <script>
        // Load GIFs ngay l·∫≠p t·ª©c, kh√¥ng ƒë·ª£i DOM
        (function () {
            const reindeer = new Image();
            reindeer.src = 'assets/images/h∆∞u nh·∫£y.gif';
            const santa = new Image();
            santa.src = 'assets/images/√¥ng gi√† noel.gif';
        })();
    </script>
    <link rel="stylesheet" href="src/css/style.css">
    <link rel="stylesheet" href="src/css/components/style-modern-quiz.css">
    <link rel="stylesheet" href="src/css/components/style-updated.css">
    <link rel="stylesheet" href="src/css/components/style-ai-quiz.css">
    <link rel="stylesheet" href="src/css/responsive/style-responsive-enhanced.css">
    <link rel="stylesheet" href="src/css/responsive/style-mobile-enhanced.css">
    <link rel="stylesheet" href="src/css/responsive/style-mobile-optimized.css">
    <link rel="stylesheet" href="src/css/components/style-streak.css">
    <link rel="stylesheet" href="src/css/components/style-explore.css">
    <link rel="stylesheet" href="src/css/components/style-analytics.css">
    <link rel="stylesheet" href="src/css/components/style-room.css">
    <!-- üé† QUIZ CAROUSEL - HI·ªÜU ·ª®NG L∆Ø·ªöT T·ª∞ ƒê·ªòNG -->
    <link rel="stylesheet" href="src/css/components/style-quiz-carousel.css">
    <!-- üåô THEME TOGGLE - N√öT B·∫¨T T·∫ÆT ƒê√àN -->
    <link rel="stylesheet" href="src/css/components/style-theme-toggle.css">
    <!-- üéÑ THEME NOEL & T·∫æT 2026 üéä -->
    <link rel="stylesheet" href="src/css/style-newyear-2026.css">
    <!-- üê± HI·ªÜU ·ª®NG CH√ÄO M·ª™NG CON M√àO -->
    <link rel="stylesheet" href="src/css/components/cat-welcome.css">
    <!-- üéØ GIAO DI·ªÜN L√ÄM B√ÄI M∆Ø·ª¢T M√Ä -->
    <!-- <link rel="stylesheet" href="src/css/components/style-smooth-quiz.css"> DISABLED - File not found -->

    <!-- üé† CAROUSEL - S·ª≠ d·ª•ng CSS t·ª´ file external style-quiz-carousel.css -->
    <!-- üö´ T·∫ÆT ƒê∆Ø·ªúNG K·∫∫ DI CHUY·ªÇN -->
    <style>
        /* Ch·ªâ x√≥a g·∫°ch ·ªü Chu·ªói ng√†y h·ªçc (streak-card) */
        .streak-card::before,
        .streak-card::after,
        .stat-card::before {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            animation: none !important;
            transition: none !important;
            transform: none !important;
        }
    </style>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- JSZip library for reading Word files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- üéÖ Rive Animation Library for Santa Claus -->
    <script src="https://unpkg.com/@rive-app/canvas@2.7.0"></script>

</head>

<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" id="mobile-menu-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <!-- Main Layout -->
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <i class="fas fa-graduation-cap logo-icon"></i>
                    <span class="logo-text">QuizTva Studio</span>
                </div>
                <button class="sidebar-toggle" id="sidebar-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <div class="sidebar-content">
                <!-- User Section -->
                <div class="sidebar-section">
                    <div class="user-profile">
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="user-info">
                            <div class="user-name">C√° nh√¢n</div>
                        </div>
                    </div>
                </div>

                <!-- Main Menu -->
                <div class="nav-wrap">
                    <div class="bubble active"></div>
                    <div class="bubble hover"></div>
                    <nav class="sidebar-nav">
                        <div class="nav-section">
                            <a href="#" class="nav-item active" data-tab="home">
                                <i class="fas fa-home"></i>
                                <span>Trang Ch·ªß</span>
                            </a>
                            <a href="#" class="nav-item" data-tab="input">
                                <i class="fas fa-plus-circle"></i>
                                <span>T·∫°o B√†i Quiz</span>
                                <span class="nav-item-badge hot">‚Ä¢</span>
                            </a>
                            <a href="#" class="nav-item" data-tab="ai-quiz">
                                <i class="fas fa-robot"></i>
                                <span>AI T·∫°o Quiz</span>
                                <span class="nav-item-badge ai">‚Ä¢</span>
                            </a>
                            <a href="#" class="nav-item" data-tab="room">
                                <i class="fas fa-door-open"></i>
                                <span>T·∫°o Ph√≤ng Thi</span>
                                <span class="nav-item-badge new">‚Ä¢</span>
                            </a>
                            <a href="#" class="nav-item" data-tab="explore">
                                <i class="fas fa-compass"></i>
                                <span>Kh√°m Ph√° ƒê·ªÅ Thi</span>
                            </a>
                            <a href="#" class="nav-item" data-tab="manage">
                                <i class="fas fa-list"></i>
                                <span>Qu·∫£n L√Ω Quiz</span>
                            </a>
                            <a href="#" class="nav-item" data-tab="quiz">
                                <i class="fas fa-play-circle"></i>
                                <span>L√†m B√†i</span>
                            </a>
                            <a href="#" class="nav-item" data-tab="results">
                                <i class="fas fa-chart-bar"></i>
                                <span>K·∫øt Qu·∫£</span>
                            </a>
                            <a href="#" class="nav-item" data-tab="analytics" id="analytics-nav-item">
                                <i class="fas fa-chart-line"></i>
                                <span>B√°o C√°o</span>
                                <span class="admin-only-badge">‚Ä¢</span>
                            </a>
                        </div>
                    </nav>
                </div>

                <!-- Footer -->
                <div class="sidebar-footer">
                    <div class="copyright">
                        ¬© Tr·∫ßn VƒÉn Anh - 2026
                    </div>

                    <!-- üéÑ MERRY CHRISTMAS GIF ANIMATION -->
                    <div class="christmas-gif-container">
                        <img src="assets/images/Merry Christmas GIF.gif" alt="Merry Christmas" class="christmas-gif">
                        <div class="gif-overlay">
                            <div class="christmas-greeting">üéÑ Gi√°ng Sinh An L√†nh! üéÑ</div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="main-wrapper">
            <!-- Top Header -->
            <header class="top-header">
                <div class="header-left">
                    <div class="current-quiz-info">
                        <div class="quiz-avatar">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="quiz-details">
                            <div class="quiz-name">K√™nh ƒë·ªÅ thi</div>
                        </div>
                    </div>
                </div>

                <div class="header-center">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="T√¨m ki·∫øm ƒë·ªÅ thi" id="search-input">
                    </div>
                </div>

                <div class="header-right">
                    <!-- Theme Toggle Button -->
                    <div class="theme-toggle-container">
                        <label class="theme-switch">
                            <input id="theme-toggle-input" type="checkbox" />
                            <div class="theme-slider round">
                                <div class="sun-moon">
                                    <svg id="moon-dot-1" class="moon-dot" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="moon-dot-2" class="moon-dot" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="moon-dot-3" class="moon-dot" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="light-ray-1" class="light-ray" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="light-ray-2" class="light-ray" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="light-ray-3" class="light-ray" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>

                                    <svg id="cloud-1" class="cloud-dark" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="cloud-2" class="cloud-dark" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="cloud-3" class="cloud-dark" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="cloud-4" class="cloud-light" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="cloud-5" class="cloud-light" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                    <svg id="cloud-6" class="cloud-light" viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="50"></circle>
                                    </svg>
                                </div>
                                <div class="stars">
                                    <svg id="star-1" class="star" viewBox="0 0 20 20">
                                        <path
                                            d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z">
                                        </path>
                                    </svg>
                                    <svg id="star-2" class="star" viewBox="0 0 20 20">
                                        <path
                                            d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z">
                                        </path>
                                    </svg>
                                    <svg id="star-3" class="star" viewBox="0 0 20 20">
                                        <path
                                            d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z">
                                        </path>
                                    </svg>
                                    <svg id="star-4" class="star" viewBox="0 0 20 20">
                                        <path
                                            d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z">
                                        </path>
                                    </svg>
                                </div>
                            </div>
                        </label>
                    </div>

                    <button class="btn-create-quiz" data-tab="input">
                        <i class="fas fa-plus"></i>
                        <span>T·∫°o ƒë·ªÅ thi</span>
                    </button>

                    <!-- üéÑ TEXT NOEL 3D -->
                    <div class="christmas-text-3d">
                        <div class="christmas-line-1">Merry Christmas</div>
                        <div class="christmas-line-2">Happy New Year 2026</div>
                    </div>

                    <div class="user-menu">
                        <div class="user-avatar-small" id="admin-logo-trigger" style="cursor: pointer;"
                            title="Admin Access">
                            <img src="https://anhtran.id.vn/wp-content/uploads/2025/09/cropped-Generated-Image-September-18-2025-8_04PM-1.png"
                                alt="User Avatar" class="user-avatar-image">
                        </div>
                    </div>
                </div>
            </header>

            <!-- Main Content Area -->
            <main class="main-content-area">
                <!-- Home Tab -->
                <section id="home-tab" class="tab-content active">
                    <!-- Stats Section -->
                    <div class="stats-section">
                        <h2 class="section-title">Th√†nh t·ª±u h·ªçc t·∫≠p</h2>

                        <div class="stats-grid">
                            <div class="stat-card" style="position: relative; overflow: visible;">
                                <!-- üéÖ SANTA CLAUS GIF ON TOP -->
                                <img src="assets/images/√¥ng gi√† noel.gif" alt="Santa Claus" class="santa-on-card"
                                    loading="eager" fetchpriority="high" decoding="async"
                                    style="position: absolute; top: -30px; right: 10px; width: 60px; z-index: 10;">

                                <div class="stat-icon blue">
                                    <i class="fas fa-book-open"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">T·ªïng s·ªë quiz</div>
                                    <div class="stat-value" id="total-quizzes">0</div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-icon green">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">ƒê√£ ho√†n th√†nh</div>
                                    <div class="stat-value" id="completed-quizzes">0</div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-icon purple">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">ƒêi·ªÉm trung b√¨nh</div>
                                    <div class="stat-value" id="average-score">0</div>
                                </div>
                            </div>

                            <div class="stat-card streak-card" onclick="quizManager.showStreakDetails()"
                                style="position: relative; overflow: visible;">
                                <!-- ü¶å JUMPING REINDEER ON TOP -->
                                <img src="assets/images/h∆∞u nh·∫£y.gif" alt="Jumping Reindeer" class="reindeer-on-card"
                                    loading="eager" fetchpriority="high" decoding="async"
                                    style="position: absolute; top: -30px; right: 10px; width: 60px; z-index: 10;">

                                <div class="stat-icon red">
                                    <i class="fas fa-fire"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-label">Chu·ªói ng√†y h·ªçc</div>
                                    <div class="stat-value" id="streak-days">0</div>
                                    <div class="stat-sublabel" id="streak-message">B·∫Øt ƒë·∫ßu h·ªçc h√¥m nay!</div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <!-- Quiz Carousel Section -->
                    <div class="recent-section carousel-section">
                        <div class="section-header">
                            <h2 class="section-title">üìö Quiz C·ªßa B·∫°n</h2>
                            <a href="#" class="view-more" data-tab="manage">Xem t·∫•t c·∫£</a>
                        </div>

                        <!-- User Quiz Carousel -->
                        <div class="user-quiz-carousel-container" id="user-quiz-carousel-container">
                            <!-- Empty State - Hi·ªÉn th·ªã khi ch∆∞a c√≥ quiz -->
                            <div class="empty-state-3d" id="empty-state-3d">
                                <div class="empty-state-icon">
                                    <i class="fas fa-folder-open"></i>
                                </div>
                                <h3>Ch∆∞a c√≥ quiz n√†o</h3>
                                <p>H√£y t·∫°o quiz ƒë·∫ßu ti√™n c·ªßa b·∫°n!</p>
                                <button class="btn-primary" data-tab="input">
                                    <i class="fas fa-plus"></i>
                                    T·∫°o quiz m·ªõi
                                </button>
                            </div>

                            <!-- Carousel - Hi·ªÉn th·ªã khi c√≥ quiz -->
                            <div class="carousel-main-section" id="carousel-main-section" style="display: none;">
                                <div class="carousel-3d-container">
                                    <button class="nav-arrow up">
                                        <i class="fas fa-chevron-up"></i>
                                    </button>

                                    <div class="carousel-3d-track" id="carousel-3d-track">
                                        <!-- Quiz cards s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông b·∫±ng JavaScript -->
                                    </div>

                                    <button class="nav-arrow down">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Controls Section -->
                            <div class="carousel-controls-section" id="carousel-controls-section"
                                style="display: none;">
                                <div class="nav-controls-3d">
                                    <button class="nav-arrow up">
                                        <i class="fas fa-chevron-up"></i>
                                    </button>
                                    <button class="nav-arrow down">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>

                                <div class="quiz-info-3d">
                                    <h3 class="quiz-name-3d">Ch·ªçn m·ªôt quiz ƒë·ªÉ xem th√¥ng tin</h3>
                                    <p class="quiz-subject-3d">M√¥ t·∫£ quiz s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</p>
                                </div>

                                <div class="dots-3d" id="dots-3d-container">
                                    <!-- Dots s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông b·∫±ng JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Shared Quiz Carousel Section -->
                    <div class="recent-section carousel-section">
                        <div class="section-header">
                            <h2 class="section-title">üåê Quiz ƒê√£ Chia S·∫ª</h2>
                            <a href="#" class="view-more" data-tab="explore">Xem t·∫•t c·∫£</a>
                        </div>

                        <div class="quiz-grid" id="shared-quiz-carousel">
                            <div class="empty-state-card">
                                <i class="fas fa-globe"></i>
                                <h3>ƒêang t·∫£i quiz ƒë√£ chia s·∫ª...</h3>
                                <p>Vui l√≤ng ƒë·ª£i trong gi√¢y l√°t</p>
                            </div>
                        </div>
                    </div>

                    <!-- Features Section -->
                    <div class="features-section">
                        <h2 class="section-title">T√≠nh nƒÉng n·ªïi b·∫≠t</h2>
                        <div class="features-grid">
                            <div class="feature-card">
                                <div class="feature-icon"><i class="fas fa-magic"></i></div>
                                <h3>T·∫°o Quiz Nhanh</h3>
                                <p>Nh·∫≠p c√¢u h·ªèi v√† ƒë√°p √°n ƒë∆°n gi·∫£n, h·ªá th·ªëng t·ª± ƒë·ªông x·ª≠ l√Ω</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
                                <h3>Qu·∫£n L√Ω Th√¥ng Minh</h3>
                                <p>Ch·ªânh s·ª≠a, sao ch√©p, x√≥a quiz d·ªÖ d√†ng</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon"><i class="fas fa-mobile-alt"></i></div>
                                <h3>Responsive</h3>
                                <p>Ho·∫°t ƒë·ªông m∆∞·ª£t m√† tr√™n m·ªçi thi·∫øt b·ªã</p>
                            </div>
                        </div>
                    </div>


                </section>

                <!-- Input Tab -->
                <section id="input-tab" class="tab-content">
                    <div class="page-header">
                        <h2 class="page-title">
                            <i class="fas fa-plus-circle"></i>
                            T·∫°o B√†i Quiz M·ªõi
                        </h2>
                    </div>

                    <div class="form-card">
                        <div class="form-group">
                            <label>T√™n b√†i quiz</label>
                            <input type="text" id="quiz-title" placeholder="Nh·∫≠p t√™n b√†i quiz..." class="form-input">
                        </div>

                        <div class="form-group">
                            <label>M√¥ t·∫£</label>
                            <textarea id="quiz-description" placeholder="M√¥ t·∫£ b√†i quiz (kh√¥ng b·∫Øt bu·ªôc)..."
                                class="form-textarea"></textarea>
                        </div>

                        <div class="form-group">
                            <label>
                                <i class="fas fa-question-circle"></i>
                                C√¢u h·ªèi v√† l·ª±a ch·ªçn
                            </label>
                            <button class="btn-paste-inline"
                                onclick="quizManager.pasteFromClipboard('questions-input')">
                                <i class="fas fa-paste"></i>
                                D√°n
                            </button>
                            <button class="btn-paste-inline" onclick="quizManager.autoFormatQuestions()"
                                title="T·ª± ƒë·ªông t√°ch vƒÉn b·∫£n tr·∫£i ngang th√†nh nhi·ªÅu d√≤ng">
                                <i class="fas fa-magic"></i>
                                T·ª± ƒë·ªông ƒë·ªãnh d·∫°ng
                            </button>
                            <textarea id="questions-input"
                                placeholder="Nh·∫≠p c√¢u h·ªèi (h·ªó tr·ª£ nhi·ªÅu format):&#10;&#10;C√¢u 1: Th·ªß ƒë√¥ c·ªßa Vi·ªát Nam?&#10;A. H·ªì Ch√≠ Minh&#10;B. H√† N·ªôi&#10;&#10;Ho·∫∑c: 1. Th·ªß ƒë√¥?&#10;A) HCM&#10;B) HN&#10;&#10;Click 'Xem v√≠ d·ª•' ƒë·ªÉ bi·∫øt th√™m format"
                                class="form-textarea large" oninput="quizManager.previewQuestions()"></textarea>
                            <div id="questions-preview" class="input-preview"></div>
                            <button type="button" class="btn-help"
                                onclick="quizManager.showFormatExamples('questions')">
                                <i class="fas fa-question-circle"></i> Xem v√≠ d·ª• format
                            </button>
                        </div>

                        <div class="form-group">
                            <label>
                                <i class="fas fa-check-circle"></i>
                                ƒê√°p √°n ƒë√∫ng
                            </label>
                            <button class="btn-paste-inline" onclick="quizManager.pasteFromClipboard('answers-input')">
                                <i class="fas fa-paste"></i>
                                D√°n
                            </button>
                            <textarea id="answers-input"
                                placeholder="Nh·∫≠p ƒë√°p √°n (h·ªó tr·ª£ nhi·ªÅu format):&#10;&#10;C√¢u 1: B&#10;C√¢u 2: A&#10;&#10;Ho·∫∑c: 1. B&#10;2. A&#10;&#10;Ho·∫∑c ƒë∆°n gi·∫£n: B&#10;A"
                                class="form-textarea" oninput="quizManager.previewAnswers()"></textarea>
                            <div id="answers-preview" class="input-preview"></div>
                            <button type="button" class="btn-help" onclick="quizManager.showFormatExamples('answers')">
                                <i class="fas fa-question-circle"></i> Xem v√≠ d·ª• format
                            </button>
                        </div>

                        <div class="form-actions">
                            <button class="btn-primary" id="process-quiz">
                                <i class="fas fa-magic"></i>
                                X·ª≠ l√Ω & T·∫°o quiz
                            </button>
                            <button class="btn-secondary" id="clear-input">
                                <i class="fas fa-trash"></i>
                                X√≥a h·∫øt
                            </button>
                        </div>
                    </div>
                </section>

                <!-- AI Quiz Tab -->
                <section id="ai-quiz-tab" class="tab-content">
                    <div class="page-header">
                        <h2 class="page-title">
                            <i class="fas fa-robot"></i>
                            AI T·∫°o Quiz T·ª± ƒê·ªông
                        </h2>
                        <p style="margin-top: 10px; opacity: 0.9;">
                            D√°n n·ªôi dung b√†i h·ªçc, AI s·∫Ω t·ª± ƒë·ªông t·∫°o c√¢u h·ªèi tr·∫Øc nghi·ªám cho b·∫°n
                        </p>
                    </div>

                    <div class="form-card">
                        <div class="ai-info-banner">
                            <i class="fas fa-info-circle"></i>
                            <div>
                                <strong>C√°ch s·ª≠ d·ª•ng:</strong> T·∫£i file t√†i li·ªáu (Word, PDF, TXT) ho·∫∑c d√°n n·ªôi dung b√†i
                                h·ªçc v√†o √¥ b√™n d∆∞·ªõi.
                                AI s·∫Ω ph√¢n t√≠ch v√† t·ª± ƒë·ªông t·∫°o c√¢u h·ªèi tr·∫Øc nghi·ªám t·ª´ n·ªôi dung ƒë√≥.
                            </div>
                        </div>

                        <!-- File Upload Section -->
                        <div class="form-group">
                            <label>
                                <i class="fas fa-cloud-upload-alt"></i>
                                T·∫£i file t√†i li·ªáu
                            </label>
                            <div class="file-upload-area" id="file-upload-area">
                                <input type="file" id="ai-file-input" accept=".txt,.doc,.docx,.pdf"
                                    style="display: none;">
                                <div class="file-upload-content">
                                    <i class="fas fa-file-upload"></i>
                                    <h4>K√©o th·∫£ file v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</h4>
                                    <p>H·ªó tr·ª£: Word (.docx), PDF (.pdf), Text (.txt)</p>
                                    <button type="button" class="btn-secondary" id="select-file-btn">
                                        <i class="fas fa-folder-open"></i>
                                        Ch·ªçn File
                                    </button>
                                </div>
                                <div class="file-info" id="file-info" style="display: none;">
                                    <div class="file-icon">
                                        <i class="fas fa-file-alt"></i>
                                    </div>
                                    <div class="file-details">
                                        <div class="file-name" id="file-name"></div>
                                        <div class="file-size" id="file-size"></div>
                                    </div>
                                    <button type="button" class="btn-remove-file" id="remove-file-btn">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="divider-with-text">
                            <span>HO·∫∂C</span>
                        </div>

                        <div class="form-group">
                            <label>
                                <i class="fas fa-keyboard"></i>
                                Nh·∫≠p n·ªôi dung tr·ª±c ti·∫øp
                            </label>
                            <button class="btn-paste-inline" id="paste-ai-content">
                                <i class="fas fa-paste"></i>
                                D√°n
                            </button>
                            <textarea id="ai-content-input"
                                placeholder="D√°n n·ªôi dung b√†i h·ªçc v√†o ƒë√¢y...&#10;&#10;V√≠ d·ª•:&#10;Vi·ªát Nam l√† m·ªôt qu·ªëc gia n·∫±m ·ªü ƒê√¥ng Nam √Å. Th·ªß ƒë√¥ c·ªßa Vi·ªát Nam l√† H√† N·ªôi. Vi·ªát Nam c√≥ di·ªán t√≠ch kho·∫£ng 331.212 km¬≤ v√† d√¢n s·ªë kho·∫£ng 98 tri·ªáu ng∆∞·ªùi. Vi·ªát Nam c√≥ 63 t·ªânh th√†nh..."
                                class="form-textarea large" rows="12"></textarea>
                        </div>

                        <div class="form-group">
                            <label>
                                <i class="fas fa-list-ol"></i>
                                S·ªë l∆∞·ª£ng c√¢u h·ªèi
                            </label>
                            <input type="number" id="ai-question-count" value="10" min="5" max="50" class="form-input"
                                style="max-width: 200px;">
                            <small style="display: block; margin-top: 8px; opacity: 0.7;">
                                AI s·∫Ω c·ªë g·∫Øng t·∫°o s·ªë c√¢u h·ªèi n√†y (t√πy thu·ªôc v√†o ƒë·ªô d√†i n·ªôi dung)
                            </small>
                        </div>

                        <div class="form-actions">
                            <button class="btn-primary" id="generate-ai-quiz">
                                <i class="fas fa-magic"></i>
                                T·∫°o Quiz B·∫±ng AI
                            </button>
                            <button class="btn-secondary" id="clear-ai-input">
                                <i class="fas fa-trash"></i>
                                X√≥a N·ªôi Dung
                            </button>
                        </div>

                        <!-- Loading State -->
                        <div id="ai-loading" class="ai-loading" style="display: none;">
                            <div class="ai-loading-spinner"></div>
                            <div class="ai-loading-text">
                                <h3>ü§ñ AI ƒëang ph√¢n t√≠ch n·ªôi dung...</h3>
                                <p>Vui l√≤ng ƒë·ª£i trong gi√¢y l√°t</p>
                            </div>
                        </div>

                        <!-- Preview Section -->
                        <div id="ai-preview" class="ai-preview-section" style="display: none;">
                            <div class="ai-preview-header">
                                <h3>
                                    <i class="fas fa-eye"></i>
                                    Xem Tr∆∞·ªõc Quiz
                                    <span class="ai-question-count">
                                        (<span id="ai-question-total">0</span> c√¢u h·ªèi)
                                    </span>
                                </h3>
                                <div class="ai-preview-actions">
                                    <button class="btn-secondary btn-sm" id="edit-ai-quiz">
                                        <i class="fas fa-edit"></i>
                                        Ch·ªânh S·ª≠a
                                    </button>
                                </div>
                            </div>

                            <div class="form-group" style="margin-top: 20px;">
                                <label>
                                    <i class="fas fa-tag"></i>
                                    T√™n quiz
                                </label>
                                <input type="text" id="ai-quiz-name" placeholder="Nh·∫≠p t√™n cho quiz..."
                                    class="form-input">
                            </div>

                            <div id="ai-quiz-preview-content" class="ai-quiz-preview-content">
                                <!-- Questions will be inserted here -->
                            </div>

                            <div class="form-actions" style="margin-top: 30px;">
                                <button class="btn-primary" id="save-ai-quiz">
                                    <i class="fas fa-save"></i>
                                    L∆∞u Quiz
                                </button>
                                <button class="btn-secondary" id="cancel-ai-quiz">
                                    <i class="fas fa-times"></i>
                                    H·ªßy
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Explore Tab - REDESIGNED ADAPTIVE LAYOUT -->
                <!-- Explore Tab -->
                <section id="explore-tab" class="tab-content">
                    <!-- üéØ ADAPTIVE HEADER & CONTROLS - Ch·ªâ s·ª≠a ph·∫ßn tr√™n -->
                    <div class="explore-top-section">
                        <!-- üì± DEVICE-AWARE HEADER -->
                        <div class="explore-header-adaptive">
                            <div class="explore-title-section">
                                <div class="explore-icon-wrapper">
                                    <i class="fas fa-compass"></i>
                                </div>
                                <div class="explore-title-content">
                                    <h2>Kh√°m Ph√° ƒê·ªÅ Thi</h2>
                                    <p class="explore-subtitle">Kh√°m ph√° v√† l√†m b√†i c√°c ƒë·ªÅ thi t·ª´ c·ªông ƒë·ªìng</p>
                                </div>
                            </div>
                            <div class="explore-device-indicator" id="device-indicator">
                                <i class="fas fa-desktop"></i>
                                <span>Desktop</span>
                            </div>
                        </div>

                        <!-- üé® SMART CONTROL PANEL - B·ªë c·ª•c th√¥ng minh -->
                        <div class="smart-control-panel" id="smart-control-panel">

                            <!-- User Identity Card -->
                            <div class="control-card user-identity-card">
                                <div class="card-icon">
                                    <i class="fas fa-user-circle"></i>
                                </div>
                                <div class="card-content">
                                    <label>T√™n hi·ªÉn th·ªã</label>
                                    <input type="text" id="user-name-input" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n..."
                                        class="smart-input">
                                </div>
                            </div>

                            <!-- Room Access Card -->
                            <div class="control-card room-access-card">
                                <div class="card-icon">
                                    <i class="fas fa-door-open"></i>
                                </div>
                                <div class="card-content">
                                    <label>V√†o Ph√≤ng Thi</label>
                                    <div class="room-input-group">
                                        <input type="text" id="join-room-code-input" placeholder="M√£ 6 s·ªë" maxlength="6"
                                            class="smart-input room-code">
                                        <button class="smart-btn primary" id="btn-join-room">
                                            <i class="fas fa-arrow-right"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Category Filter Card -->
                            <div class="control-card category-filter-card">
                                <div class="card-icon">
                                    <i class="fas fa-filter"></i>
                                </div>
                                <div class="card-content">
                                    <label>L·ªçc theo m√¥n</label>
                                    <select id="category-filter-select" class="smart-select">
                                        <option value="all">üéØ T·∫•t c·∫£ m√¥n h·ªçc</option>
                                        <option value="toan-cao-cap">üìê To√°n cao c·∫•p</option>
                                        <option value="vat-ly-dai-cuong">‚öóÔ∏è V·∫≠t l√Ω ƒë·∫°i c∆∞∆°ng</option>
                                        <option value="hoa-dai-cuong">üß™ H√≥a ƒë·∫°i c∆∞∆°ng</option>
                                        <option value="sinh-hoc-dai-cuong">üß¨ Sinh h·ªçc ƒë·∫°i c∆∞∆°ng</option>
                                        <option value="tieng-anh">üåç Ti·∫øng Anh</option>
                                        <option value="tin-hoc-dai-cuong">üíª Tin h·ªçc ƒë·∫°i c∆∞∆°ng</option>
                                        <option value="kinh-te-hoc">üí∞ Kinh t·∫ø h·ªçc</option>
                                        <option value="quan-tri-kinh-doanh">üìä Qu·∫£n tr·ªã kinh doanh</option>
                                        <option value="ke-toan">üìã K·∫ø to√°n</option>
                                        <option value="marketing">üìà Marketing</option>
                                        <option value="luat-hoc">‚öñÔ∏è Lu·∫≠t h·ªçc</option>
                                        <option value="tam-ly-hoc">üß† T√¢m l√Ω h·ªçc</option>
                                        <option value="giao-duc-hoc">üéì Gi√°o d·ª•c h·ªçc</option>
                                        <option value="ngoai-ngu">üó£Ô∏è Ngo·∫°i ng·ªØ</option>
                                        <option value="cong-nghe-thong-tin">üîß C√¥ng ngh·ªá th√¥ng tin</option>
                                        <option value="dien-tu-vien-thong">üì° ƒêi·ªán t·ª≠ vi·ªÖn th√¥ng</option>
                                        <option value="co-khi">‚öôÔ∏è C∆° kh√≠</option>
                                        <option value="xay-dung">üèóÔ∏è X√¢y d·ª±ng</option>
                                        <option value="y-hoc">üè• Y h·ªçc</option>
                                        <option value="duoc-hoc">üíä D∆∞·ª£c h·ªçc</option>
                                        <option value="nong-nghiep">üåæ N√¥ng nghi·ªáp</option>
                                        <option value="thuy-san">üêü Th·ªßy s·∫£n</option>
                                        <option value="lam-nghiep">üå≤ L√¢m nghi·ªáp</option>
                                        <option value="moi-truong">üåç M√¥i tr∆∞·ªùng</option>
                                        <option value="khac">üìö Kh√°c</option>
                                    </select>
                                    <div class="filter-result" id="filter-result-text">
                                        Hi·ªÉn th·ªã t·∫•t c·∫£ t√†i li·ªáu
                                    </div>
                                </div>
                            </div>

                            <!-- Action Card -->
                            <div class="control-card action-card">
                                <button class="smart-btn secondary full-width" id="refresh-shared-quizzes">
                                    <i class="fas fa-sync-alt"></i>
                                    <span>L√†m m·ªõi</span>
                                </button>
                            </div>

                            <!-- Debug Permission Card -->
                            <div class="control-card action-card">
                                <button class="smart-btn warning full-width"
                                    onclick="exploreQuizManager.showPermissionDebugUI()"
                                    title="Ki·ªÉm tra quy·ªÅn ch·ªânh s·ª≠a/x√≥a b√†i thi">
                                    <i class="fas fa-shield-alt"></i>
                                    <span>Ki·ªÉm tra quy·ªÅn</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- üéØ ORIGINAL QUIZ DISPLAY AREA - Gi·ªØ nguy√™n nh∆∞ c≈© -->
                    <!-- Loading State -->
                    <div id="explore-loading" class="explore-loading">
                        <div class="explore-loading-spinner"></div>
                        <div class="explore-loading-text">ƒêang t·∫£i ƒë·ªÅ thi...</div>
                    </div>

                    <!-- Shared Quizzes Section - New Horizontal Layout -->
                    <div class="shared-quizzes-section" id="shared-quizzes-section">
                        <!-- Trending Quizzes -->
                        <div class="quiz-section">
                            <div class="section-header">
                                <h3><i class="fas fa-fire"></i> ƒê·ªÅ thi l√™n xu h∆∞·ªõng</h3>
                                <button class="btn-see-more" onclick="exploreQuizManager.showAllQuizzes('trending')">
                                    <span>Xem th√™m</span>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            <div class="quiz-container-wrapper">
                                <div class="quiz-horizontal-scroll" id="trending-quizzes">
                                    <div class="quiz-loading">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        <span>ƒêang t·∫£i ƒë·ªÅ thi xu h∆∞·ªõng...</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Latest Quizzes - 3D Carousel -->
                        <div class="quiz-section">
                            <div class="section-header">
                                <h3><i class="fas fa-clock"></i> ƒê·ªÅ thi m·ªõi nh·∫•t</h3>
                                <button class="btn-see-more" onclick="exploreQuizManager.showAllQuizzes('latest')">
                                    <span>Xem th√™m</span>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>

                            <!-- Latest Quiz Carousel Horizontal -->
                            <div class="explore-quiz-carousel-horizontal" id="latest-quiz-carousel-container">
                                <!-- Loading State -->
                                <div class="explore-loading-state" id="latest-loading-state">
                                    <div class="loading-icon">
                                        <i class="fas fa-spinner fa-spin"></i>
                                    </div>
                                    <h3>ƒêang t·∫£i ƒë·ªÅ thi m·ªõi nh·∫•t...</h3>
                                    <p>Vui l√≤ng ƒë·ª£i trong gi√¢y l√°t</p>
                                </div>

                                <!-- Horizontal Carousel -->
                                <div class="explore-carousel-horizontal-section" id="latest-carousel-main-section"
                                    style="display: none;">

                                    <button class="explore-nav-arrow left" onclick="latestQuizCarousel3D.navigate(-1)">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>

                                    <div class="explore-carousel-horizontal-track" id="latest-carousel-3d-track">
                                        <!-- Quiz cards s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông b·∫±ng JavaScript -->
                                    </div>

                                    <button class="explore-nav-arrow right" onclick="latestQuizCarousel3D.navigate(1)">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>

                                <!-- Info Section -->
                                <div class="explore-carousel-info-section" id="latest-carousel-controls-section"
                                    style="display: none;">
                                    <div class="explore-quiz-info-horizontal">
                                        <h3 class="explore-quiz-name-3d">Ch·ªçn m·ªôt quiz ƒë·ªÉ xem th√¥ng tin</h3>
                                        <p class="explore-quiz-subject-3d">M√¥ t·∫£ quiz s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</p>
                                    </div>

                                    <div class="explore-dots-horizontal" id="latest-dots-3d-container">
                                        <!-- Dots s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông b·∫±ng JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Room Tab - T·∫°o Ph√≤ng Thi -->
                <section id="room-tab" class="tab-content">
                    <div class="page-header">
                        <h2 class="page-title">
                            <i class="fas fa-door-open"></i>
                            T·∫°o Ph√≤ng Thi
                        </h2>
                        <p style="margin-top: 10px; opacity: 0.9;">
                            T·∫°o ph√≤ng thi ri√™ng ƒë·ªÉ chia s·∫ª v·ªõi l·ªõp h·ªçc m√† kh√¥ng c·∫ßn chia s·∫ª l√™n c·ªông ƒë·ªìng
                        </p>
                    </div>

                    <!-- Room Creation Section -->
                    <div class="room-creation-section">
                        <div class="room-creation-header">
                            <i class="fas fa-plus-circle"></i>
                            <h3>T·∫°o Ph√≤ng Thi M·ªõi</h3>
                        </div>

                        <div class="room-form-grid">
                            <div class="room-form-group">
                                <label>
                                    <i class="fas fa-signature"></i>
                                    T√™n ph√≤ng <span style="color: red;">*</span>
                                </label>
                                <input type="text" id="room-name-input" placeholder="V√≠ d·ª•: Ki·ªÉm tra To√°n 10 - Ch∆∞∆°ng 1"
                                    maxlength="100">
                            </div>

                            <div class="room-form-group">
                                <label>
                                    <i class="fas fa-key"></i>
                                    M√£ ph√≤ng (6 s·ªë) <span style="color: red;">*</span>
                                </label>
                                <div class="room-code-generator">
                                    <input type="text" id="room-code-input" placeholder="Nh·∫≠p ho·∫∑c t·∫°o t·ª± ƒë·ªông"
                                        maxlength="6" pattern="[0-9]{6}">
                                    <button class="btn-generate-code" id="btn-generate-room-code">
                                        <i class="fas fa-random"></i>
                                        T·∫°o m√£
                                    </button>
                                </div>
                                <small class="room-code-note">
                                    M√£ ph√≤ng d√πng ƒë·ªÉ ng∆∞·ªùi kh√°c tham gia
                                </small>
                            </div>

                            <div class="room-form-group room-quiz-selector">
                                <label>
                                    <i class="fas fa-book"></i>
                                    Ch·ªçn ƒë·ªÅ thi <span style="color: red;">*</span>
                                </label>
                                <select id="room-quiz-selector">
                                    <option value="">-- Ch·ªçn ƒë·ªÅ thi t·ª´ Qu·∫£n l√Ω Quiz --</option>
                                </select>
                                <small class="room-code-note">
                                    ƒê·ªÅ thi ph·∫£i ƒë∆∞·ª£c t·∫°o tr∆∞·ªõc trong m·ª•c "Qu·∫£n l√Ω Quiz"
                                </small>
                            </div>

                            <div class="room-form-group" style="grid-column: 1 / -1;">
                                <label>
                                    <i class="fas fa-align-left"></i>
                                    M√¥ t·∫£ ph√≤ng
                                </label>
                                <textarea id="room-description-input" placeholder="M√¥ t·∫£ ng·∫Øn g·ªçn v·ªÅ ph√≤ng thi n√†y..."
                                    rows="3"></textarea>
                            </div>
                        </div>

                        <div class="room-actions">
                            <button class="btn-create-room" id="btn-create-room">
                                <i class="fas fa-plus-circle"></i>
                                T·∫°o Ph√≤ng Thi
                            </button>
                        </div>
                    </div>

                    <!-- My Rooms Section -->
                    <div class="my-rooms-section">
                        <div class="my-rooms-header">
                            <h3>
                                <i class="fas fa-list"></i>
                                Ph√≤ng Thi C·ªßa T√¥i
                            </h3>
                            <button class="btn-refresh" id="refresh-my-rooms">
                                <i class="fas fa-sync-alt"></i>
                                L√†m m·ªõi
                            </button>
                        </div>

                        <!-- Loading State -->
                        <div id="rooms-loading" class="room-loading" style="display: none;">
                            <div class="room-loading-spinner"></div>
                            <div class="room-loading-text">ƒêang t·∫£i ph√≤ng thi...</div>
                        </div>

                        <!-- Rooms Grid -->
                        <div class="rooms-grid" id="my-rooms-grid">
                            <div class="rooms-empty-state">
                                <i class="fas fa-door-open"></i>
                                <h3>Ch∆∞a c√≥ ph√≤ng thi n√†o</h3>
                                <p>H√£y t·∫°o ph√≤ng thi ƒë·∫ßu ti√™n c·ªßa b·∫°n!</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Manage Tab -->
                <section id="manage-tab" class="tab-content">
                    <div class="page-header">
                        <h2 class="page-title">
                            <i class="fas fa-cog"></i>
                            Qu·∫£n L√Ω Quiz
                        </h2>
                    </div>

                    <div id="quiz-list" class="quiz-manage-list">
                        <div class="empty-state-card">
                            <i class="fas fa-folder-open"></i>
                            <h3>Ch∆∞a c√≥ quiz n√†o</h3>
                            <p>H√£y t·∫°o quiz ƒë·∫ßu ti√™n c·ªßa b·∫°n!</p>
                        </div>
                    </div>
                </section>

                <!-- Quiz Tab -->
                <section id="quiz-tab" class="tab-content">
                    <div class="page-header">
                        <h2 class="page-title">
                            <i class="fas fa-play"></i>
                            L√†m B√†i Tr·∫Øc Nghi·ªám
                        </h2>
                    </div>

                    <div class="quiz-start-card">
                        <div class="quiz-controls-modern">
                            <div class="quiz-control-group">
                                <label>
                                    <i class="fas fa-clipboard-list"></i>
                                    Ch·ªçn b√†i quiz
                                </label>
                                <select id="quiz-selector" class="form-select">
                                    <option value="">-- Ch·ªçn b√†i quiz ƒë·ªÉ l√†m --</option>
                                </select>
                            </div>

                            <div class="quiz-control-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="shuffle-questions">
                                    <span class="checkbox-custom"></span>
                                    <span class="checkbox-text">
                                        <i class="fas fa-random"></i>
                                        X√°o tr·ªôn c√¢u h·ªèi
                                    </span>
                                </label>
                            </div>

                            <div class="quiz-control-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="enable-sound" checked>
                                    <span class="checkbox-custom"></span>
                                    <span class="checkbox-text">
                                        <i class="fas fa-volume-up"></i>
                                        B·∫≠t √¢m thanh
                                    </span>
                                </label>
                            </div>

                            <button id="start-quiz" class="btn-primary btn-large" disabled>
                                <i class="fas fa-play"></i>
                                B·∫Øt ƒê·∫ßu L√†m B√†i
                            </button>
                        </div>
                    </div>

                    <div id="quiz-container" class="quiz-container"></div>
                </section>

                <!-- Results Tab -->
                <section id="results-tab" class="tab-content">
                    <div class="page-header">
                        <h2 class="page-title">
                            <i class="fas fa-trophy"></i>
                            K·∫øt Qu·∫£ L√†m B√†i
                        </h2>
                    </div>

                    <div id="results-container" class="results-container">
                        <div class="empty-state-card">
                            <i class="fas fa-chart-line"></i>
                            <h3>Ch∆∞a c√≥ k·∫øt qu·∫£ n√†o</h3>
                            <p>Ho√†n th√†nh m·ªôt b√†i quiz ƒë·ªÉ xem k·∫øt qu·∫£</p>
                        </div>
                    </div>
                </section>

                <!-- Analytics Tab (Admin Only) -->
                <section id="analytics-tab" class="tab-content">
                    <div class="page-header">
                        <h2 class="page-title">
                            <i class="fas fa-chart-line"></i>
                            B√°o C√°o Analytics
                            <span class="admin-only-badge" style="margin-left: 15px;">Admin Only</span>
                        </h2>
                        <p style="margin-top: 10px; opacity: 0.9;">
                            Theo d√µi ho·∫°t ƒë·ªông ng∆∞·ªùi d√πng, thi·∫øt b·ªã, v·ªã tr√≠ v√† th·ªëng k√™ truy c·∫≠p
                        </p>
                    </div>

                    <div id="analytics-content">
                        <!-- Content will be loaded by admin-analytics.js -->
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Modal for editing quiz -->
    <div id="edit-modal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Ch·ªânh S·ª≠a Quiz</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <input type="text" id="edit-title" placeholder="T√™n quiz..." class="modal-input">
                <textarea id="edit-description" placeholder="M√¥ t·∫£..." class="modal-textarea"></textarea>
                <div id="edit-questions" class="edit-questions"></div>
            </div>
            <div class="modal-footer">
                <button id="save-edit" class="btn-primary">
                    <i class="fas fa-save"></i>
                    L∆∞u Thay ƒê·ªïi
                </button>
                <button id="cancel-edit" class="btn-secondary">
                    <i class="fas fa-times"></i>
                    H·ªßy
                </button>
            </div>
        </div>
    </div>

    <!-- Modal for quiz details -->
    <div id="quiz-details-modal" class="modal">
        <div class="quiz-details-modal-content modal-content">
            <div class="quiz-details-content">
                <!-- Content will be inserted here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Admin Password Modal -->
    <div id="admin-password-modal" class="modal">
        <div class="modal-overlay" onclick="adminManager.closePasswordModal()"></div>
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3><i class="fas fa-shield-alt"></i> Admin Access</h3>
                <button class="modal-close" onclick="adminManager.closePasswordModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>
                        <i class="fas fa-lock"></i>
                        Nh·∫≠p m·∫≠t kh·∫©u Admin (6 s·ªë)
                    </label>
                    <input type="password" id="admin-password-input" placeholder="Nh·∫≠p m·∫≠t kh·∫©u..." class="form-input"
                        maxlength="6" style="text-align: center; font-size: 24px; letter-spacing: 10px;">
                    <small style="display: block; margin-top: 8px; color: var(--text-secondary);">
                        Ch·ªâ Admin m·ªõi c√≥ quy·ªÅn truy c·∫≠p
                    </small>
                </div>
                <div id="admin-error-message"
                    style="display: none; color: #ef4444; margin-top: 10px; text-align: center;">
                    <i class="fas fa-exclamation-circle"></i>
                    M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="adminManager.verifyPassword()">
                    <i class="fas fa-sign-in-alt"></i>
                    ƒêƒÉng Nh·∫≠p
                </button>
                <button class="btn-secondary" onclick="adminManager.closePasswordModal()">
                    <i class="fas fa-times"></i>
                    H·ªßy
                </button>
            </div>
        </div>
    </div>

    <!-- Room Details Modal -->
    <div id="room-details-modal" class="room-details-modal">
        <div class="room-details-content">
            <div class="room-details-modal-content">
                <!-- Content will be inserted here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- User Name Modal -->
    <div id="user-name-modal" class="user-name-modal">
        <div class="user-name-content">
            <div class="user-name-modal-content">
                <!-- Content will be inserted here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Modal for sharing quiz -->
    <div id="share-quiz-modal" class="modal">
        <div class="modal-overlay" onclick="exploreQuizManager.closeShareModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-share-alt"></i> Chia S·∫ª ƒê·ªÅ Thi</h3>
                <button class="modal-close" onclick="exploreQuizManager.closeShareModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="share-info-banner">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>L∆∞u √Ω:</strong> B·∫°n c√≥ th·ªÉ ƒë·∫∑t t√™n v√† m√¥ t·∫£ m·ªõi cho b√†i chia s·∫ª.
                        B√†i g·ªëc c·ªßa b·∫°n s·∫Ω kh√¥ng b·ªã thay ƒë·ªïi.
                    </div>
                </div>

                <div class="form-group" style="margin-top: 20px;">
                    <label>
                        <i class="fas fa-user-circle"></i>
                        T√™n c·ªßa b·∫°n <span style="color: red;">*</span>
                    </label>
                    <input type="text" id="share-user-name" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n..." class="modal-input">
                    <small style="display: block; margin-top: 5px; color: var(--text-secondary);">
                        T√™n n√†y s·∫Ω hi·ªÉn th·ªã cho m·ªçi ng∆∞·ªùi bi·∫øt ai ƒë√£ chia s·∫ª
                    </small>
                </div>

                <div class="form-group">
                    <label>
                        <i class="fas fa-heading"></i>
                        T√™n ƒë·ªÅ thi <span style="color: red;">*</span>
                    </label>
                    <input type="text" id="share-quiz-title" placeholder="Nh·∫≠p t√™n ƒë·ªÅ thi..." class="modal-input">
                    <small style="display: block; margin-top: 5px; color: var(--text-secondary);">
                        ƒê·∫∑t t√™n m·ªõi cho ƒë·ªÅ thi khi chia s·∫ª (kh√°c v·ªõi t√™n g·ªëc)
                    </small>
                </div>

                <div class="form-group">
                    <label>
                        <i class="fas fa-tags"></i>
                        Danh m·ª•c <span style="color: red;">*</span>
                    </label>
                    <select id="share-quiz-category" class="modal-select">
                        <option value="">-- Ch·ªçn m√¥n h·ªçc --</option>
                        <option value="toan-cao-cap">üìê To√°n cao c·∫•p</option>
                        <option value="vat-ly-dai-cuong">‚öóÔ∏è V·∫≠t l√Ω ƒë·∫°i c∆∞∆°ng</option>
                        <option value="hoa-dai-cuong">üß™ H√≥a ƒë·∫°i c∆∞∆°ng</option>
                        <option value="sinh-hoc-dai-cuong">üß¨ Sinh h·ªçc ƒë·∫°i c∆∞∆°ng</option>
                        <option value="tieng-anh">üåç Ti·∫øng Anh</option>
                        <option value="tin-hoc-dai-cuong">üíª Tin h·ªçc ƒë·∫°i c∆∞∆°ng</option>
                        <option value="kinh-te-hoc">üí∞ Kinh t·∫ø h·ªçc</option>
                        <option value="quan-tri-kinh-doanh">üìä Qu·∫£n tr·ªã kinh doanh</option>
                        <option value="ke-toan">üìã K·∫ø to√°n</option>
                        <option value="marketing">üìà Marketing</option>
                        <option value="luat-hoc">‚öñÔ∏è Lu·∫≠t h·ªçc</option>
                        <option value="tam-ly-hoc">üß† T√¢m l√Ω h·ªçc</option>
                        <option value="giao-duc-hoc">üéì Gi√°o d·ª•c h·ªçc</option>
                        <option value="ngoai-ngu">üó£Ô∏è Ngo·∫°i ng·ªØ</option>
                        <option value="cong-nghe-thong-tin">üîß C√¥ng ngh·ªá th√¥ng tin</option>
                        <option value="dien-tu-vien-thong">üì° ƒêi·ªán t·ª≠ vi·ªÖn th√¥ng</option>
                        <option value="co-khi">‚öôÔ∏è C∆° kh√≠</option>
                        <option value="xay-dung">üèóÔ∏è X√¢y d·ª±ng</option>
                        <option value="y-hoc">üè• Y h·ªçc</option>
                        <option value="duoc-hoc">üíä D∆∞·ª£c h·ªçc</option>
                        <option value="nong-nghiep">üåæ N√¥ng nghi·ªáp</option>
                        <option value="thuy-san">üêü Th·ªßy s·∫£n</option>
                        <option value="lam-nghiep">üå≤ L√¢m nghi·ªáp</option>
                        <option value="moi-truong">üåç M√¥i tr∆∞·ªùng</option>
                        <option value="khac">üìö Kh√°c</option>
                    </select>
                    <small style="display: block; margin-top: 5px; color: var(--text-secondary);">
                        Ch·ªçn danh m·ª•c ph√π h·ª£p ƒë·ªÉ ng∆∞·ªùi kh√°c d·ªÖ t√¨m th·∫•y
                    </small>
                </div>

                <div class="form-group">
                    <label>
                        <i class="fas fa-align-left"></i>
                        M√¥ t·∫£ ƒë·ªÅ thi
                    </label>
                    <textarea id="share-quiz-description" placeholder="Nh·∫≠p m√¥ t·∫£ cho ƒë·ªÅ thi..." class="modal-textarea"
                        rows="4"></textarea>
                    <small style="display: block; margin-top: 5px; color: var(--text-secondary);">
                        M√¥ t·∫£ ng·∫Øn g·ªçn v·ªÅ n·ªôi dung ƒë·ªÅ thi
                    </small>
                </div>

                <div class="share-quiz-info">
                    <div class="info-item">
                        <i class="fas fa-question-circle"></i>
                        <span>S·ªë c√¢u h·ªèi: <strong id="share-quiz-count">0</strong></span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-calendar"></i>
                        <span>Ng√†y chia s·∫ª: <strong id="share-quiz-date">H√¥m nay</strong></span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-clock"></i>
                        <span>Th·ªùi gian: <strong id="share-quiz-time">B√¢y gi·ªù</strong></span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="exploreQuizManager.confirmShareQuiz()">
                    <i class="fas fa-share-alt"></i>
                    Chia S·∫ª Ngay
                </button>
                <button class="btn-secondary" onclick="exploreQuizManager.closeShareModal()">
                    <i class="fas fa-times"></i>
                    H·ªßy
                </button>
            </div>
        </div>
    </div>

    <script src="src/js/config/cloud-storage.js"></script>
    <script>
        window.firebaseQuizManager = new CloudQuizManager();
        window.isFirebaseInitialized = true;
        window.firebaseQuizManager.startAutoSync();
        console.log('‚úÖ Cloud storage ready');
    </script>

    <!-- Community Sharing - Kh√¥ng c·∫ßn server, kh√¥ng c·∫ßn c√πng m·∫°ng -->
    <script src="src/js/features/community-share.js"></script>

    <!-- Supabase Integration - Cloud sharing -->
    <script type="module" src="src/js/config/supabase-config.js"></script>

    <!-- Smart Question Parser - Nh·∫≠n di·ªán t·ª± ƒë·ªông nhi·ªÅu format -->
    <script src="src/js/core/smart-question-parser.js"></script>

    <!-- Sound Manager - Qu·∫£n l√Ω √¢m thanh (MUST BE BEFORE script.js) -->
    <script src="src/js/features/sound-manager.js"></script>

    <script src="src/js/core/script.js"></script>

    <!-- üé† USER QUIZ CAROUSEL 3D JAVASCRIPT - LOAD EARLY -->
    <script src="archive/old-versions/script-modern.js"></script>
    <!-- PATCH: Fix updateAnswerModern - MUST BE RIGHT AFTER script-modern.js -->
    <script src="archive/fixes/PATCH_UPDATE_ANSWER.js"></script>
    <script src="archive/old-versions/script-updated.js"></script>
    <script src="src/js/features/ai-quiz.js"></script>
    <script src="src/js/features/ai-file-handler.js"></script>
    <script src="src/js/features/mobile-menu.js"></script>
    <!-- Theme Toggle Manager - Qu·∫£n l√Ω chuy·ªÉn ƒë·ªïi theme -->
    <script src="src/js/components/theme-toggle.js"></script>
    <script src="src/js/features/streak-tracker.js"></script>
    <script src="src/js/features/explore-quiz.js"></script>

    <!-- FORCE SUPABASE FIX V2 - MUST BE RIGHT AFTER explore-quiz.js -->
    <script src="archive/fixes/FIX_FORCE_SUPABASE_V2.js"></script>

    <script src="src/js/admin/admin-manager.js"></script>

    <!-- Analytics Tracker -->
    <script src="src/js/admin/analytics-tracker.js"></script>

    <!-- Admin Analytics Dashboard -->
    <script src="src/js/admin/admin-analytics.js"></script>

    <!-- Room Manager -->
    <script src="src/js/room/room-manager.js"></script>

    <!-- FINAL ABSOLUTE FIX: Ch·∫∑n PATCH request, b·∫£o v·ªá currentQuiz 100% -->
    <script src="archive/fixes/FINAL_ABSOLUTE_FIX.js"></script>

    <script>
        // Override renderQuiz with modern version for 3-column layout
        document.addEventListener('DOMContentLoaded', function () {
            if (typeof QuizManager !== 'undefined') {
                // Override methods to use modern 3-column layout
                QuizManager.prototype.renderQuiz = QuizManager.prototype.renderQuizModern;
                QuizManager.prototype.startTimer = QuizManager.prototype.startTimerModern;
                QuizManager.prototype.updateProgressBar = QuizManager.prototype.updateProgressBarModern;
                QuizManager.prototype.updateAnswer = QuizManager.prototype.updateAnswerModern;

                console.log('‚úÖ Modern quiz layout activated!');
            }

            // Initialize Analytics Dashboard when clicking Analytics tab
            const analyticsNavItem = document.getElementById('analytics-nav-item');
            if (analyticsNavItem) {
                analyticsNavItem.addEventListener('click', function () {
                    // Wait for tab to switch
                    setTimeout(() => {
                        if (window.adminAnalytics) {
                            window.adminAnalytics.loadDashboard();
                        }
                    }, 100);
                });
            }
        });
    </script>

    <!-- ROOM QUIZ VALIDATION & UPGRADE - MUST BE AFTER ROOM MANAGER -->
    <script src="src/js/room/room-quiz-validation-upgrade.js"></script>

    <!-- COMPLETE PROTECTION FOR ROOM QUIZ - MUST BE ABSOLUTE LAST -->
    <script src="archive/fixes/fix-room-quiz-complete-protection.js"></script>

    <!-- ABSOLUTE QUIZ PROTECTION - MUST BE VERY LAST -->
    <script src="src/js/core/ABSOLUTE_QUIZ_PROTECTION.js"></script>

    <!-- üéÑ HI·ªÜU ·ª®NG NOEL & T·∫æT 2026 üéä -->
    <script src="src/js/features/newyear-effects.js"></script>

    <!-- üéÑ HI·ªÜU ·ª®NG TUY·∫æT R∆†I ƒê·ªöN GI·∫¢N -->
    <!-- <script src="archive/deprecated/simple-snow.js"></script> DISABLED - File not found -->

    <!-- üê± HI·ªÜU ·ª®NG CH√ÄO M·ª™NG CON M√àO -->
    <script src="src/js/features/cat-welcome.js"></script>

    <!-- üéØ GIAO DI·ªÜN L√ÄM B√ÄI M∆Ø·ª¢T M√Ä -->
    <script src="src/js/core/smooth-quiz-effects.js"></script>

    <!-- Audio for answer selection -->
    <audio id="answer-sound" preload="auto">
        <source src="assets/audio/chinhxac.wav" type="audio/wav">
    </audio>

    <!-- Audio for quiz results -->
    <audio id="success-sound" preload="auto">
        <source src="assets/audio/√¢m thanh ch√∫c m·ª´ng.wav" type="audio/wav">
    </audio>
    <audio id="fail-sound" preload="auto">
        <source src="assets/audio/saidapan.wav" type="audio/wav">
    </audio>

    <!-- CSS cho h·ªá th·ªëng danh m·ª•c -->
    <style>
        /* Modal Select Styling */
        .modal-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color, #e1e5e9);
            border-radius: 8px;
            background: var(--bg-color, #ffffff);
            color: var(--text-color, #2d3748);
            font-size: 16px;
            font-family: inherit;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 12px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
        }

        .modal-select:focus {
            outline: none;
            border-color: var(--primary-color, #4f46e5);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        /* Category Filter Section - Compact Design */
        .category-filter-compact {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            padding: 0 20px;
        }

        .filter-compact-wrapper {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-width: 280px;
        }

        .category-select-compact {
            padding: 10px 14px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: var(--text-color, #2d3748);
            font-size: 14px;
            font-family: inherit;
            font-weight: 500;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23667eea' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 10px center;
            background-repeat: no-repeat;
            background-size: 14px;
            padding-right: 35px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .category-select-compact:focus {
            outline: none;
            border-color: var(--primary-color, #667eea);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .category-select-compact:hover {
            border-color: var(--primary-color, #667eea);
            background: rgba(255, 255, 255, 0.15);
        }

        .filter-result-compact {
            text-align: right;
            font-size: 12px;
            color: var(--text-secondary, #64748b);
            font-weight: 500;
        }

        .filter-result-compact span {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 4px 8px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .category-filter-compact {
                justify-content: center;
            }

            .filter-compact-wrapper {
                max-width: 100%;
                width: 100%;
            }

            .filter-result-compact {
                text-align: center;
            }
        }

        /* Dark theme support */
        @media (prefers-color-scheme: dark) {
            .category-select-compact {
                background: rgba(45, 55, 72, 0.8);
                border-color: rgba(255, 255, 255, 0.1);
                color: #e2e8f0;
            }

            .filter-result-compact span {
                background: rgba(45, 55, 72, 0.8);
                border-color: rgba(255, 255, 255, 0.1);
                color: #e2e8f0;
            }
        }

        /* Shared Quiz Category */
        .shared-quiz-category {
            background: var(--primary-color, #4f46e5);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-left: auto;
        }

        .shared-quiz-category i {
            font-size: 10px;
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            .category-filter-section {
                background: #1a202c;
                border-color: #2d3748;
            }

            .category-select {
                background: #2d3748;
                border-color: #4a5568;
                color: #e2e8f0;
            }

            .filter-result-count span {
                background: #2d3748;
                border-color: #4a5568;
                color: #e2e8f0;
            }

            .modal-select {
                background: #2d3748;
                border-color: #4a5568;
                color: #e2e8f0;
            }
        }

        /* Shared Quizzes Section - Horizontal Layout */
        .shared-quizzes-section {
            margin-top: 20px;
            width: 100%;
            max-width: 100%;
            overflow: hidden;
        }

        .quiz-section {
            margin-bottom: 40px;
            width: 100%;
            max-width: 100%;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding: 0 8px;
        }

        .section-header h3 {
            color: var(--text-color, #2d3748);
            font-size: 22px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0;
        }

        .section-header h3 i {
            color: var(--primary-color, #667eea);
            font-size: 20px;
        }

        .btn-see-more {
            background: rgba(102, 126, 234, 0.08);
            border: 2px solid rgba(102, 126, 234, 0.15);
            color: var(--primary-color, #667eea);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(10px);
        }

        .btn-see-more:hover {
            background: var(--primary-color, #667eea);
            color: white;
            border-color: var(--primary-color, #667eea);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        /* CRITICAL: Container wrapper to prevent layout stretching */
        .quiz-container-wrapper {
            width: 100% !important;
            max-width: 100% !important;
            height: 450px !important;
            overflow: hidden !important;
            position: relative;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
            contain: layout style !important;
        }

        border-radius: 12px;
        background: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        contain: layout style !important;
        }

        .quiz-horizontal-scroll {
            display: flex;
            gap: 24px;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 20px;
            scroll-behavior: smooth;
            scrollbar-width: thin;
            flex-wrap: nowrap;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        .quiz-horizontal-scroll::-webkit-scrollbar {
            height: 10px;
        }

        .quiz-horizontal-scroll::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.08);
            border-radius: 12px;
        }

        .quiz-horizontal-scroll::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-color, #667eea), var(--secondary-color, #764ba2));
            border-radius: 12px;
            border: 2px solid transparent;
            background-clip: content-box;
        }

        .quiz-horizontal-scroll::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--primary-dark, #5a67d8), var(--secondary-dark, #6b46c1));
            background-clip: content-box;
        }

        .quiz-card-horizontal {
            min-width: 320px;
            max-width: 320px;
            width: 320px;
            height: auto;
            min-height: 360px;
            flex-shrink: 0;
            background: var(--card-bg, #ffffff);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border-color, #e1e5e9);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            backdrop-filter: blur(10px);
        }

        .quiz-card-horizontal:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.15);
            border-color: var(--primary-color, #667eea);
        }

        .quiz-card-horizontal::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(135deg, var(--primary-color, #667eea), var(--secondary-color, #764ba2));
            border-radius: 20px 20px 0 0;
        }

        .quiz-card-horizontal::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
            border-radius: 50%;
            transition: all 0.4s ease;
            opacity: 0;
        }

        .quiz-card-horizontal:hover::after {
            opacity: 1;
            transform: scale(1.5);
        }

        /* üéØ ENHANCED STYLES FOR LONG TEXT CARDS */
        .quiz-card-long-text {
            border-left: 4px solid #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.02), rgba(255, 255, 255, 0.98));
        }

        .quiz-card-long-text .quiz-card-title {
            font-weight: 600;
            color: #2d3748;
        }

        .quiz-card-long-text::before {
            background: linear-gradient(135deg, #667eea, #764ba2, #48bb78);
            height: 5px;
        }

        /* üîß ENSURE BUTTON VISIBILITY */
        .quiz-card-practice-action,
        .quiz-card-actions {
            margin-top: auto;
            flex-shrink: 0;
            position: relative;
            z-index: 10;
            padding-top: 8px;
        }

        .quiz-card-content {
            display: flex;
            flex-direction: column;
            height: 100%;
            justify-content: space-between;
        }

        /* üì± RESPONSIVE IMPROVEMENTS FOR LONG TEXT */
        @media (max-width: 480px) {
            .quiz-card-long-text .quiz-card-title {
                font-size: 13px;
                line-height: 1.25;
            }
        }

        @media (max-width: 360px) {
            .quiz-card-long-text .quiz-card-title {
                font-size: 12px;
                line-height: 1.2;
            }
        }

        .quiz-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
            position: relative;
            z-index: 2;
        }

        .quiz-card-category {
            background: linear-gradient(135deg, var(--primary-color, #667eea), var(--secondary-color, #764ba2));
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(10px);
        }

        .quiz-card-stats {
            display: flex;
            gap: 12px;
            font-size: 13px;
            color: var(--text-secondary, #64748b);
        }

        .quiz-card-stat {
            display: flex;
            align-items: center;
            gap: 4px;
            background: var(--bg-secondary, #f8fafc);
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: 500;
        }

        .quiz-card-stat i {
            color: var(--primary-color, #667eea);
        }

        .quiz-card-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-color, #2d3748);
            margin-bottom: 14px;
            line-height: 1.25;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            height: auto;
            min-height: 48px;
            max-height: 72px;
            position: relative;
            z-index: 2;
            word-wrap: break-word;
            word-break: break-word;
            hyphens: auto;
        }

        .quiz-card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 0;
            overflow: hidden;
        }

        .quiz-card-meta {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 16px;
            font-size: 14px;
            color: var(--text-secondary, #64748b);
        }

        .quiz-card-meta-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .quiz-card-meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .quiz-card-meta-item i {
            color: var(--primary-color, #667eea);
            width: 16px;
        }

        .quiz-card-actions {
            display: flex;
            gap: 12px;
            position: relative;
            z-index: 2;
            margin-bottom: 8px;
            justify-content: center;
            flex-shrink: 0;
        }

        .quiz-card-actions-secondary {
            display: flex;
            gap: 12px;
            position: relative;
            z-index: 2;
        }

        .quiz-card-practice-action {
            margin-top: 6px;
            position: relative;
            z-index: 2;
            flex-shrink: 0;
        }

        .btn-quiz-practice-full {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            border-radius: 25px;
            font-size: 15px;
            font-weight: 700;
            padding: 14px 20px;
            border: none;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .btn-quiz-practice-full:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }

        .btn-quiz-practice-full::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }

        .btn-quiz-practice-full:hover::before {
            left: 100%;
        }

        .btn-quiz-practice-full i {
            background: rgba(255, 255, 255, 0.25);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-quiz-action {
            flex: 1;
            padding: 14px 18px;
            border: none;
            border-radius: 14px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn-quiz-primary {
            background: linear-gradient(135deg, var(--primary-color, #667eea), var(--secondary-color, #764ba2));
            color: white;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.35);
        }

        .btn-quiz-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.45);
        }

        .btn-quiz-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn-quiz-primary:hover::before {
            left: 100%;
        }

        .btn-quiz-secondary {
            background: rgba(102, 126, 234, 0.08);
            color: var(--primary-color, #667eea);
            border: 2px solid rgba(102, 126, 234, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            min-width: 120px;
        }

        .btn-quiz-secondary:hover {
            background: rgba(102, 126, 234, 0.12);
            border-color: var(--primary-color, #667eea);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.2);
        }

        .quiz-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 40px;
            color: var(--text-secondary, #64748b);
            font-size: 14px;
        }

        .quiz-loading i {
            color: var(--primary-color, #667eea);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary, #64748b);
        }

        .empty-state i {
            font-size: 48px;
            color: var(--border-color, #e1e5e9);
            margin-bottom: 16px;
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--text-color, #2d3748);
        }

        /* CRITICAL: Override any conflicting styles */
        #trending-quizzes,
        #latest-quizzes {
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            overflow-x: auto;
            overflow-y: hidden;
        }

        #trending-quizzes .quiz-card-horizontal,
        #latest-quizzes .quiz-card-horizontal {
            flex: 0 0 320px;
            width: 320px;
            height: 360px;
        }

        /* CRITICAL: Prevent explore tab from stretching - MINIMAL CSS */
        #explore-tab {
            overflow-x: hidden;
        }

        /* CRITICAL: Force all sections to stay within viewport */
        .user-name-section,
        .room-join-section,
        .category-filter-compact,
        .explore-header,
        .shared-quizzes-section {
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
        }

        /* MINIMAL: Force main layout constraints - ONLY FOR EXPLORE */

        /* Responsive - Adaptive Layout System */
        @media (max-width: 360px) {
            .quiz-container-wrapper {
                height: 360px !important;
                max-width: 100% !important;
                margin: 0 8px;
            }

            .quiz-card-horizontal {
                min-width: 260px !important;
                max-width: 260px !important;
                width: 260px !important;
                height: 320px !important;
                padding: 14px !important;
            }

            .quiz-card-title {
                font-size: 14px !important;
                line-height: 1.2 !important;
                max-height: 67px !important;
                -webkit-line-clamp: 4 !important;
                height: auto !important;
                margin-bottom: 10px;
            }

            .quiz-card-meta {
                font-size: 11px;
                gap: 6px;
            }

            .btn-quiz-secondary {
                padding: 6px 12px;
                font-size: 11px;
                min-width: 80px;
            }

            .btn-quiz-practice-full {
                padding: 8px 12px;
                font-size: 12px;
            }

            .btn-quiz-practice-full i {
                width: 20px;
                height: 20px;
                font-size: 10px;
            }
        }

        @media (min-width: 361px) and (max-width: 414px) {
            .quiz-container-wrapper {
                height: 380px !important;
                max-width: 100% !important;
                margin: 0 10px;
            }

            .quiz-card-horizontal {
                min-width: 280px !important;
                max-width: 280px !important;
                width: 280px !important;
                height: 340px !important;
                padding: 16px !important;
            }

            .quiz-card-title {
                font-size: 15px !important;
                line-height: 1.25 !important;
                max-height: 75px !important;
                -webkit-line-clamp: 4 !important;
                height: auto !important;
                margin-bottom: 12px;
            }

            .quiz-card-meta {
                font-size: 12px;
                gap: 7px;
            }

            .btn-quiz-secondary {
                padding: 8px 14px;
                font-size: 12px;
                min-width: 90px;
            }

            .btn-quiz-practice-full {
                padding: 10px 14px;
                font-size: 13px;
            }

            .btn-quiz-practice-full i {
                width: 22px;
                height: 22px;
                font-size: 11px;
            }
        }

        @media (min-width: 415px) and (max-width: 768px) {
            .quiz-container-wrapper {
                height: 400px !important;
                max-width: 100% !important;
                margin: 0 15px;
            }

            .quiz-card-horizontal {
                min-width: 320px !important;
                max-width: 320px !important;
                width: 320px !important;
                height: 360px !important;
                padding: 18px !important;
            }

            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .section-header h3 {
                font-size: 18px;
            }

            .quiz-card-title {
                font-size: 17px;
                height: 46px;
            }

            .quiz-card-meta {
                gap: 8px;
                margin-bottom: 14px;
                font-size: 13px;
            }

            .btn-quiz-action {
                padding: 10px 14px;
                font-size: 13px;
            }

            .btn-quiz-practice-full {
                padding: 12px 18px;
                font-size: 14px;
            }

            .btn-quiz-practice-full i {
                width: 26px;
                height: 26px;
                font-size: 13px;
            }
        }

        padding: 4px 8px;
        }

        .btn-quiz-action {
            padding: 8px 10px;
            font-size: 12px;
        }

        /* üé† USER QUIZ CAROUSEL 3D STYLES */
        .user-quiz-carousel-container {
            display: flex;
            gap: 40px;
            align-items: center;
            justify-content: center;
            min-height: 500px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 20px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
        }

        /* Empty State */
        .empty-state-3d {
            text-align: center;
            padding: 60px 40px;
            color: #64748b;
            width: 100%;
            max-width: 500px;
        }

        .empty-state-icon {
            font-size: 64px;
            color: #cbd5e1;
            margin-bottom: 24px;
        }

        .empty-state-3d h3 {
            font-size: 24px;
            font-weight: 700;
            color: #475569;
            margin-bottom: 12px;
        }

        .empty-state-3d p {
            font-size: 16px;
            color: #64748b;
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .empty-state-3d .btn-primary {
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 25px rgba(108, 92, 231, 0.3);
        }

        .empty-state-3d .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(108, 92, 231, 0.4);
        }

        .carousel-main-section {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .carousel-3d-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .carousel-3d-track {
            position: relative;
            width: 350px;
            height: 450px;
            perspective: 1000px;
        }

        .quiz-card-3d {
            position: absolute;
            width: 300px;
            height: 400px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(20px);
            left: 50%;
            top: 50%;
            transform-origin: center center;
        }

        .quiz-card-3d.center {
            transform: translate(-50%, -50%) scale(1) rotateY(0deg);
            z-index: 5;
            opacity: 1;
        }

        .quiz-card-3d.up-1 {
            transform: translate(-50%, -50%) translateY(-80px) scale(0.85) rotateY(15deg);
            z-index: 4;
            opacity: 0.8;
        }

        .quiz-card-3d.up-2 {
            transform: translate(-50%, -50%) translateY(-140px) scale(0.7) rotateY(25deg);
            z-index: 3;
            opacity: 0.6;
        }

        .quiz-card-3d.down-1 {
            transform: translate(-50%, -50%) translateY(80px) scale(0.85) rotateY(15deg);
            z-index: 4;
            opacity: 0.8;
        }

        .quiz-card-3d.down-2 {
            transform: translate(-50%, -50%) translateY(140px) scale(0.7) rotateY(25deg);
            z-index: 3;
            opacity: 0.6;
        }

        .quiz-card-3d.hidden {
            transform: translate(-50%, -50%) scale(0.5) rotateY(35deg);
            z-index: 1;
            opacity: 0.3;
        }

        .quiz-card-3d-header {
            height: 180px;
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .quiz-card-3d-icon {
            font-size: 48px;
            opacity: 0.9;
        }

        .quiz-card-3d-content {
            padding: 25px;
            height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .quiz-card-3d-title {
            font-size: 16px;
            font-weight: 700;
            color: #2d3436;
            margin-bottom: 8px;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .quiz-card-3d-description {
            font-size: 13px;
            color: #636e72;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .quiz-card-3d-meta {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .quiz-meta-item-3d {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            color: #74b9ff;
            background: rgba(116, 185, 255, 0.1);
            padding: 4px 8px;
            border-radius: 12px;
            border: 1px solid rgba(116, 185, 255, 0.2);
        }

        .quiz-start-btn-3d {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
        }

        .quiz-start-btn-3d:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(108, 92, 231, 0.3);
        }

        /* Controls Section */
        .carousel-controls-section {
            width: 280px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .nav-controls-3d {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .nav-arrow {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
            color: #6c5ce7;
        }

        .nav-arrow:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(108, 92, 231, 0.2);
        }

        .quiz-info-3d {
            text-align: center;
            color: #2d3436;
            background: rgba(255, 255, 255, 0.8);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .quiz-name-3d {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
            transition: opacity 0.3s ease;
            line-height: 1.3;
        }

        .quiz-subject-3d {
            font-size: 14px;
            opacity: 0.8;
            transition: opacity 0.3s ease;
            margin: 0;
        }

        .dots-3d {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .dot-3d {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(108, 92, 231, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dot-3d.active {
            background: #6c5ce7;
            transform: scale(1.2);
        }

        /* Color Variants */
        .quiz-card-3d:nth-child(3n+1) .quiz-card-3d-header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa726 100%);
        }

        .quiz-card-3d:nth-child(3n+2) .quiz-card-3d-header {
            background: linear-gradient(135deg, #4ecdc4 0%, #45b7d1 100%);
        }

        .quiz-card-3d:nth-child(3n+3) .quiz-card-3d-header {
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .user-quiz-carousel-container {
                flex-direction: column;
                gap: 30px;
                min-height: 600px;
            }

            .carousel-controls-section {
                width: 100%;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }

            .nav-controls-3d {
                flex-direction: row;
                gap: 20px;
            }

            .quiz-info-3d {
                flex: 1;
                margin: 0 20px;
            }
        }

        @media (max-width: 768px) {
            .carousel-3d-container {
                max-width: 350px;
                height: 450px;
            }

            .carousel-3d-track {
                width: 300px;
                height: 400px;
            }

            .quiz-card-3d {
                width: 260px;
                height: 350px;
            }

            .quiz-card-3d-content {
                padding: 20px;
                height: 170px;
            }

            .quiz-card-3d-header {
                height: 150px;
            }

            .quiz-card-3d-title {
                font-size: 15px;
            }

            .quiz-info-3d {
                padding: 20px;
            }

            .quiz-name-3d {
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .user-quiz-carousel-container {
                padding: 15px;
                min-height: 500px;
            }

            .carousel-3d-container {
                max-width: 300px;
                height: 400px;
            }

            .carousel-3d-track {
                width: 280px;
                height: 350px;
            }

            .quiz-card-3d {
                width: 240px;
                height: 320px;
            }

            .quiz-card-3d-content {
                padding: 18px;
                height: 160px;
            }

            .quiz-card-3d-header {
                height: 140px;
            }

            .quiz-card-3d-icon {
                font-size: 36px;
            }

            .quiz-card-3d-title {
                font-size: 14px;
                -webkit-line-clamp: 2;
            }

            .quiz-card-3d-description {
                font-size: 12px;
            }

            .quiz-meta-item-3d {
                font-size: 10px;
                padding: 3px 6px;
            }

            .quiz-start-btn-3d {
                padding: 10px;
                font-size: 13px;
            }

            .quiz-info-3d {
                padding: 15px;
            }

            .quiz-name-3d {
                font-size: 14px;
            }

            .quiz-subject-3d {
                font-size: 12px;
            }

            .nav-arrow {
                width: 40px;
                height: 40px;
            }

            .dot-3d {
                width: 10px;
                height: 10px;
            }
        }

        /* üé† END USER QUIZ CAROUSEL 3D STYLES */

        /* üåê EXPLORE QUIZ CAROUSEL HORIZONTAL STYLES */
        .explore-quiz-carousel-horizontal {
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        /* üöÄ PERFORMANCE OPTIMIZATIONS */
        .question-card {
            will-change: transform;
            contain: layout style paint;
        }

        .option {
            will-change: background-color;
            transition: background-color 0.1s ease, transform 0.1s ease;
            cursor: pointer;
        }

        .option:hover {
            transform: translateZ(0) scale(1.01);
        }

        .option.selected {
            background-color: #e3f2fd !important;
            border-color: #2196f3 !important;
            transform: translateZ(0);
        }

        .progress-bar {
            will-change: width;
            transition: width 0.2s ease;
        }

        /* Smooth scrolling for quiz container */
        .questions-container {
            scroll-behavior: smooth;
        }

        /* Optimize radio button interactions */
        input[type="radio"] {
            will-change: transform;
            transition: transform 0.1s ease;
        }

        input[type="radio"]:checked {
            transform: scale(1.1);
        }

        /* Optimize text rendering */
        .question-text,
        .option-text {
            text-rendering: optimizeSpeed;
        }

        /* Reduce repaints */
        .option-label {
            backface-visibility: hidden;
        }

        /* Loading State */
        .explore-loading-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            text-align: center;
        }

        .explore-loading-state .loading-icon {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 20px;
        }

        .explore-loading-state h3 {
            font-size: 20px;
            font-weight: 600;
            color: #2d3748;
            margin: 0 0 8px 0;
        }

        .explore-loading-state p {
            font-size: 14px;
            color: #718096;
            margin: 0;
        }

        /* Horizontal Carousel Section */
        .explore-carousel-horizontal-section {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        .explore-carousel-horizontal-track {
            flex: 1;
            display: flex;
            gap: 20px;
            overflow-x: auto;
            scroll-behavior: smooth;
            padding: 10px 0;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .explore-carousel-horizontal-track::-webkit-scrollbar {
            display: none;
        }

        /* Navigation Arrows */
        .explore-nav-arrow {
            width: 48px;
            height: 48px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            flex-shrink: 0;
        }

        .explore-nav-arrow:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .explore-nav-arrow:active {
            transform: translateY(0);
        }

        /* Quiz Cards - Horizontal Layout */
        .explore-quiz-card-horizontal {
            min-width: 350px;
            width: 350px;
            min-height: 340px;
            height: auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            flex-shrink: 0;
            position: relative;
        }

        .explore-quiz-card-horizontal:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .explore-quiz-card-horizontal-header {
            height: 110px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            flex-shrink: 0;
        }

        .explore-quiz-card-horizontal-icon {
            font-size: 40px;
            opacity: 0.9;
        }

        .explore-quiz-card-horizontal-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(255, 255, 255, 0.9);
            color: #667eea;
            font-size: 11px;
            font-weight: 700;
            padding: 5px 10px;
            border-radius: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .explore-quiz-card-horizontal-content {
            padding: 20px;
            min-height: 230px;
            height: auto;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .explore-quiz-card-horizontal-title {
            font-size: 17px;
            font-weight: 700;
            color: #2d3748;
            margin: 0;
            line-height: 1.4;
            word-wrap: break-word;
            overflow-wrap: break-word;
            flex-shrink: 0;
        }

        .explore-quiz-card-horizontal-description {
            font-size: 14px;
            color: #636e72;
            line-height: 1.5;
            margin: 0;
            word-wrap: break-word;
            overflow-wrap: break-word;
            flex-shrink: 0;
        }

        .explore-quiz-card-horizontal-meta {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: auto;
            flex-shrink: 0;
        }

        .explore-quiz-meta-item-horizontal {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 13px;
            color: #718096;
            background: #f7fafc;
            padding: 5px 10px;
            border-radius: 6px;
            font-weight: 500;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .explore-quiz-start-btn-horizontal {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .explore-quiz-start-btn-horizontal:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        /* Color Variants */
        .explore-quiz-card-horizontal:nth-child(3n+1) .explore-quiz-card-horizontal-header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa726 100%);
        }

        .explore-quiz-card-horizontal:nth-child(3n+2) .explore-quiz-card-horizontal-header {
            background: linear-gradient(135deg, #4ecdc4 0%, #45b7d1 100%);
        }

        .explore-quiz-card-horizontal:nth-child(3n+3) .explore-quiz-card-horizontal-header {
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
        }

        /* Info Section - HIDDEN */
        .explore-carousel-info-section {
            display: none !important;
        }

        .explore-quiz-info-horizontal h3 {
            font-size: 16px;
            font-weight: 600;
            color: #2d3748;
            margin: 0 0 4px 0;
        }

        .explore-quiz-info-horizontal p {
            font-size: 13px;
            color: #718096;
            margin: 0;
        }

        /* Dots */
        .explore-dots-horizontal {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .explore-dot-horizontal {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #cbd5e0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .explore-dot-horizontal.active {
            background: #667eea;
            transform: scale(1.2);
        }

        .explore-carousel-main-section {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .explore-carousel-3d-container {
            position: relative;
            width: 100%;
            max-width: 350px;
            height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .explore-carousel-3d-track {
            position: relative;
            width: 300px;
            height: 350px;
            perspective: 1000px;
        }

        .explore-quiz-card-3d {
            position: absolute;
            width: 260px;
            height: 320px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(15px);
            left: 50%;
            top: 50%;
            transform-origin: center center;
        }

        .explore-quiz-card-3d.center {
            transform: translate(-50%, -50%) scale(1) rotateY(0deg);
            z-index: 5;
            opacity: 1;
        }

        .explore-quiz-card-3d.up-1 {
            transform: translate(-50%, -50%) translateY(-70px) scale(0.85) rotateY(12deg);
            z-index: 4;
            opacity: 0.8;
        }

        .explore-quiz-card-3d.up-2 {
            transform: translate(-50%, -50%) translateY(-120px) scale(0.7) rotateY(20deg);
            z-index: 3;
            opacity: 0.6;
        }

        .explore-quiz-card-3d.down-1 {
            transform: translate(-50%, -50%) translateY(70px) scale(0.85) rotateY(12deg);
            z-index: 4;
            opacity: 0.8;
        }

        .explore-quiz-card-3d.down-2 {
            transform: translate(-50%, -50%) translateY(120px) scale(0.7) rotateY(20deg);
            z-index: 3;
            opacity: 0.6;
        }

        .explore-quiz-card-3d.hidden {
            transform: translate(-50%, -50%) scale(0.5) rotateY(30deg);
            z-index: 1;
            opacity: 0.3;
        }

        .explore-quiz-card-3d-header {
            height: 140px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .explore-quiz-card-3d-icon {
            font-size: 36px;
            opacity: 0.9;
        }

        .explore-quiz-card-3d-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(255, 255, 255, 0.9);
            color: #667eea;
            font-size: 10px;
            font-weight: 700;
            padding: 4px 8px;
            border-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .explore-quiz-card-3d-content {
            padding: 20px;
            height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .explore-quiz-card-3d-title {
            font-size: 14px;
            font-weight: 700;
            color: #2d3436;
            margin-bottom: 6px;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .explore-quiz-card-3d-description {
            font-size: 12px;
            color: #636e72;
            margin-bottom: 12px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .explore-quiz-card-3d-meta {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .explore-quiz-meta-item-3d {
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 10px;
            color: #74b9ff;
            background: rgba(116, 185, 255, 0.1);
            padding: 3px 6px;
            border-radius: 10px;
            border: 1px solid rgba(116, 185, 255, 0.2);
        }

        .explore-quiz-start-btn-3d {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 12px;
        }

        .explore-quiz-start-btn-3d:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        /* Controls Section */
        .explore-carousel-controls-section {
            width: 240px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
        }

        .explore-nav-controls-3d {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .explore-nav-arrow {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(15px);
            color: #667eea;
        }

        .explore-nav-arrow:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.2);
        }

        .explore-quiz-info-3d {
            text-align: center;
            color: #2d3436;
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 16px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        }

        .explore-quiz-name-3d {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 6px;
            transition: opacity 0.3s ease;
            line-height: 1.3;
        }

        .explore-quiz-subject-3d {
            font-size: 12px;
            opacity: 0.8;
            transition: opacity 0.3s ease;
            margin: 0;
        }

        .explore-dots-3d {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .explore-dot-3d {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(102, 126, 234, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .explore-dot-3d.active {
            background: #667eea;
            transform: scale(1.2);
        }

        /* Color Variants */
        .explore-quiz-card-3d:nth-child(3n+1) .explore-quiz-card-3d-header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa726 100%);
        }

        .explore-quiz-card-3d:nth-child(3n+2) .explore-quiz-card-3d-header {
            background: linear-gradient(135deg, #4ecdc4 0%, #45b7d1 100%);
        }

        .explore-quiz-card-3d:nth-child(3n+3) .explore-quiz-card-3d-header {
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .explore-quiz-carousel-container {
                flex-direction: column;
                gap: 20px;
                min-height: 500px;
            }

            .explore-carousel-controls-section {
                width: 100%;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }

            .explore-nav-controls-3d {
                flex-direction: row;
                gap: 15px;
            }

            .explore-quiz-info-3d {
                flex: 1;
                margin: 0 15px;
            }
        }

        @media (max-width: 768px) {
            .explore-carousel-3d-container {
                max-width: 300px;
                height: 350px;
            }

            .explore-carousel-3d-track {
                width: 280px;
                height: 320px;
            }

            .explore-quiz-card-3d {
                width: 240px;
                height: 300px;
            }

            .explore-quiz-card-3d-content {
                padding: 16px;
                height: 160px;
            }

            .explore-quiz-card-3d-header {
                height: 120px;
            }

            .explore-quiz-card-3d-title {
                font-size: 13px;
            }

            .explore-quiz-info-3d {
                padding: 16px;
            }

            .explore-quiz-name-3d {
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            .explore-quiz-carousel-container {
                padding: 15px;
                min-height: 400px;
            }

            .explore-carousel-3d-container {
                max-width: 280px;
                height: 320px;
            }

            .explore-carousel-3d-track {
                width: 260px;
                height: 300px;
            }

            .explore-quiz-card-3d {
                width: 220px;
                height: 280px;
            }

            .explore-quiz-card-3d-content {
                padding: 14px;
                height: 150px;
            }

            .explore-quiz-card-3d-header {
                height: 110px;
            }

            .explore-quiz-card-3d-icon {
                font-size: 28px;
            }

            .explore-quiz-card-3d-title {
                font-size: 12px;
                -webkit-line-clamp: 2;
            }

            .explore-quiz-card-3d-description {
                font-size: 11px;
            }

            .explore-quiz-meta-item-3d {
                font-size: 9px;
                padding: 2px 4px;
            }

            .explore-quiz-start-btn-3d {
                padding: 8px;
                font-size: 11px;
            }

            .explore-quiz-info-3d {
                padding: 12px;
            }

            .explore-quiz-name-3d {
                font-size: 12px;
            }

            .explore-quiz-subject-3d {
                font-size: 10px;
            }

            .explore-nav-arrow {
                width: 35px;
                height: 35px;
            }

            .explore-dot-3d {
                width: 8px;
                height: 8px;
            }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .explore-quiz-carousel-horizontal {
                padding: 16px;
            }

            .explore-quiz-card-horizontal {
                min-width: 320px;
                width: 320px;
                min-height: 320px;
                height: auto;
            }

            .explore-quiz-card-horizontal-header {
                height: 100px;
            }

            .explore-quiz-card-horizontal-icon {
                font-size: 36px;
            }

            .explore-quiz-card-horizontal-content {
                padding: 18px;
                min-height: 220px;
                height: auto;
            }

            .explore-quiz-card-horizontal-title {
                font-size: 16px;
            }

            .explore-quiz-card-horizontal-description {
                font-size: 13px;
            }
        }

        @media (max-width: 768px) {
            .explore-carousel-horizontal-section {
                gap: 8px;
            }

            .explore-carousel-horizontal-track {
                gap: 16px;
                padding: 8px 0;
            }

            .explore-nav-arrow {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .explore-quiz-card-horizontal {
                min-width: calc(100vw - 120px);
                width: calc(100vw - 120px);
                max-width: 350px;
                min-height: 300px;
                height: auto;
            }

            .explore-quiz-card-horizontal-header {
                height: 90px;
            }

            .explore-quiz-card-horizontal-icon {
                font-size: 32px;
            }

            .explore-quiz-card-horizontal-content {
                padding: 16px;
                min-height: 210px;
                height: auto;
            }

            .explore-quiz-card-horizontal-title {
                font-size: 15px;
            }

            .explore-quiz-card-horizontal-description {
                font-size: 13px;
            }

            .explore-quiz-meta-item-horizontal {
                font-size: 12px;
                padding: 4px 8px;
            }
        }

        .explore-quiz-card-horizontal-description {
            font-size: 13px;
        }

        .explore-carousel-info-section {
            flex-direction: column;
            gap: 12px;
            text-align: center;
        }
        }

        @media (max-width: 480px) {

            /* X√≥a b·ªè ho√†n to√†n padding/margin c·ªßa container cha */
            .quiz-section {
                margin: 0;
                padding: 0;
                width: 100vw;
                margin-left: calc(-50vw + 50%);
            }

            .explore-quiz-carousel-horizontal {
                padding: 0;
                margin: 0;
                background: transparent;
                box-shadow: none;
                border-radius: 0;
                width: 100vw;
                max-width: 100vw;
            }

            .section-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
                padding: 0 15px;
                margin: 15px 0;
            }

            .section-header h3 {
                font-size: 16px;
            }

            .btn-see-more {
                align-self: stretch;
                justify-content: center;
            }

            .explore-carousel-horizontal-section {
                gap: 0;
                padding: 0;
                margin: 0;
                width: 100vw;
            }

            .explore-carousel-horizontal-track {
                gap: 15px;
                padding: 10px 0;
                scroll-snap-type: x mandatory;
                -webkit-overflow-scrolling: touch;
                width: 100vw;
            }

            .explore-quiz-card-horizontal {
                min-width: calc(100vw - 20px);
                width: calc(100vw - 20px);
                max-width: none;
                min-height: 320px;
                height: auto;
                scroll-snap-align: center;
                margin: 0 10px;
            }

            /* ·∫®n arrows ho√†n to√†n tr√™n mobile */
            .explore-nav-arrow {
                display: none !important;
                visibility: hidden !important;
                opacity: 0 !important;
                width: 0 !important;
                height: 0 !important;
                padding: 0 !important;
                margin: 0 !important;
            }

            .explore-quiz-card-horizontal-header {
                height: 80px;
            }

            .explore-quiz-card-horizontal-icon {
                font-size: 28px;
            }

            .explore-quiz-card-horizontal-badge {
                font-size: 10px;
                padding: 4px 8px;
            }

            .explore-quiz-card-horizontal-content {
                padding: 12px;
                min-height: 240px;
                height: auto;
            }

            .explore-quiz-card-horizontal-title {
                font-size: 14px;
                line-height: 1.3;
            }

            .explore-quiz-card-horizontal-description {
                font-size: 12px;
                line-height: 1.4;
            }

            .explore-quiz-card-horizontal-meta {
                gap: 6px;
                flex-direction: column;
                align-items: flex-start;
            }

            .explore-quiz-meta-item-horizontal {
                font-size: 10px;
                padding: 3px 6px;
                gap: 3px;
                width: fit-content;
            }

            .explore-quiz-start-btn-horizontal {
                padding: 10px;
                font-size: 12px;
            }
        }

        /* Extra small devices (iPhone SE, etc) */
        @media (max-width: 375px) {
            .quiz-section {
                margin: 0;
                padding: 0;
                width: 100vw;
                margin-left: calc(-50vw + 50%);
            }

            .explore-quiz-carousel-horizontal {
                padding: 0;
                background: transparent;
                width: 100vw;
                max-width: 100vw;
            }

            .section-header {
                padding: 0 12px;
                margin: 12px 0;
            }

            .explore-carousel-horizontal-section {
                width: 100vw;
            }

            .explore-carousel-horizontal-track {
                gap: 12px;
                padding: 8px 0;
                width: 100vw;
            }

            .explore-quiz-card-horizontal {
                min-width: calc(100vw - 16px);
                width: calc(100vw - 16px);
                max-width: none;
                margin: 0 8px;
                min-height: 300px;
            }

            .explore-quiz-card-horizontal-header {
                height: 75px;
            }

            .explore-quiz-card-horizontal-icon {
                font-size: 26px;
            }

            .explore-quiz-card-horizontal-content {
                padding: 10px;
            }

            .explore-quiz-card-horizontal-title {
                font-size: 13px;
            }

            .explore-quiz-card-horizontal-description {
                font-size: 11px;
            }

            .explore-quiz-card-horizontal-meta {
                gap: 4px;
                flex-direction: column;
                align-items: flex-start;
            }

            .explore-quiz-meta-item-horizontal {
                font-size: 9px;
                padding: 2px 5px;
                width: fit-content;
            }
        }

        .explore-quiz-card-horizontal-description {
            font-size: 12px;
        }
        }

        .explore-quiz-card-horizontal-description {
            font-size: 11px;
        }
        }

        /* üåê END EXPLORE QUIZ CAROUSEL HORIZONTAL STYLES */
        }
    </style>

    <script>
        // üîß DEBUG: Force horizontal layout
        document.addEventListener('DOMContentLoaded', function () {
            console.log('üîß Applying horizontal layout fixes...');

            // Force horizontal scroll containers
            const containers = document.querySelectorAll('#trending-quizzes, #latest-quizzes');
            containers.forEach(container => {
                if (container) {
                    container.style.display = 'flex';
                    container.style.flexDirection = 'row';
                    container.style.flexWrap = 'nowrap';
                    container.style.overflowX = 'auto';
                    container.style.overflowY = 'hidden';
                    container.style.gap = '24px';
                    console.log('‚úÖ Fixed container:', container.id);
                }
            });

            // Force card dimensions
            const cards = document.querySelectorAll('.quiz-card-horizontal');
            // Apply responsive card dimensions
            const applyResponsiveCardDimensions = (card) => {
                const screenWidth = window.innerWidth;

                if (screenWidth <= 480) {
                    // Mobile small
                    card.style.flex = '0 0 280px';
                    card.style.width = '280px';
                    card.style.height = '320px';
                    card.style.minWidth = '280px';
                    card.style.maxWidth = '280px';
                } else if (screenWidth <= 768) {
                    // Mobile/Tablet
                    card.style.flex = '0 0 300px';
                    card.style.width = '300px';
                    card.style.height = '360px';
                    card.style.minWidth = '300px';
                    card.style.maxWidth = '300px';
                } else {
                    // Desktop
                    card.style.flex = '0 0 340px';
                    card.style.width = '340px';
                    card.style.height = '390px';
                    card.style.minWidth = '340px';
                    card.style.maxWidth = '340px';
                }
            };

            cards.forEach(card => {
                applyResponsiveCardDimensions(card);
            });

            console.log('‚úÖ Applied fixes to', cards.length, 'cards');

            // üéØ ADAPTIVE LAYOUT SYSTEM - T·ª± ƒë·ªông nh·∫≠n di·ªán v√† ƒëi·ªÅu ch·ªânh
            const initAdaptiveLayout = () => {
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                const devicePixelRatio = window.devicePixelRatio || 1;

                console.log(`üì± Device Info: ${screenWidth}x${screenHeight}, DPR: ${devicePixelRatio}`);

                // T√≠nh to√°n k√≠ch th∆∞·ªõc t·ªëi ∆∞u d·ª±a tr√™n m√†n h√¨nh
                const calculateOptimalCardSize = () => {
                    const availableWidth = screenWidth - 60; // Tr·ª´ padding v√† margin
                    let cardWidth, cardHeight, containerHeight;

                    if (screenWidth <= 360) {
                        // ƒêi·ªán tho·∫°i r·∫•t nh·ªè (iPhone SE, Galaxy S5)
                        cardWidth = Math.min(260, availableWidth - 40);
                        cardHeight = 300;
                        containerHeight = 340;
                    } else if (screenWidth <= 414) {
                        // ƒêi·ªán tho·∫°i nh·ªè (iPhone 6/7/8, Galaxy S8)
                        cardWidth = Math.min(280, availableWidth - 40);
                        cardHeight = 320;
                        containerHeight = 360;
                    } else if (screenWidth <= 768) {
                        // ƒêi·ªán tho·∫°i l·ªõn/Tablet nh·ªè
                        cardWidth = Math.min(320, availableWidth - 40);
                        cardHeight = 360;
                        containerHeight = 400;
                    } else if (screenWidth <= 1024) {
                        // Tablet
                        cardWidth = 340;
                        cardHeight = 380;
                        containerHeight = 420;
                    } else {
                        // Desktop
                        cardWidth = 340;
                        cardHeight = 390;
                        containerHeight = 450;
                    }

                    return { cardWidth, cardHeight, containerHeight };
                };

                const { cardWidth, cardHeight, containerHeight } = calculateOptimalCardSize();

                // √Åp d·ª•ng k√≠ch th∆∞·ªõc container
                const containers = document.querySelectorAll('.quiz-container-wrapper');
                containers.forEach(container => {
                    container.style.height = `${containerHeight}px`;
                    container.style.maxWidth = `calc(100vw - 20px)`;
                });

                // √Åp d·ª•ng k√≠ch th∆∞·ªõc card
                const allCards = document.querySelectorAll('.quiz-card-horizontal');
                allCards.forEach(card => {
                    card.style.flex = `0 0 ${cardWidth}px`;
                    card.style.width = `${cardWidth}px`;
                    card.style.height = `${cardHeight}px`;
                    card.style.minWidth = `${cardWidth}px`;
                    card.style.maxWidth = `${cardWidth}px`;

                    // ƒêi·ªÅu ch·ªânh padding d·ª±a tr√™n k√≠ch th∆∞·ªõc
                    if (cardWidth <= 260) {
                        card.style.padding = '14px';
                    } else if (cardWidth <= 280) {
                        card.style.padding = '16px';
                    } else {
                        card.style.padding = '18px';
                    }
                });

                // ƒêi·ªÅu ch·ªânh scroll padding
                const scrollContainers = document.querySelectorAll('.quiz-horizontal-scroll');
                scrollContainers.forEach(scroll => {
                    if (screenWidth <= 414) {
                        scroll.style.padding = '12px 8px 16px 8px';
                        scroll.style.gap = '12px';
                    } else if (screenWidth <= 768) {
                        scroll.style.padding = '16px 12px 20px 12px';
                        scroll.style.gap = '16px';
                    } else {
                        scroll.style.padding = '20px 16px 24px 16px';
                        scroll.style.gap = '20px';
                    }
                });

                // üìù ENHANCED DYNAMIC CONTENT-AWARE LAYOUT SYSTEM - T·ª± ƒë·ªông ƒëi·ªÅu ch·ªânh theo n·ªôi dung
                const optimizeContentAwareLayout = () => {
                    const cards = document.querySelectorAll('.quiz-card-horizontal');
                    if (cards.length === 0) return;

                    console.log(`üîß Optimizing ${cards.length} cards for screen width: ${screenWidth}px`);

                    cards.forEach((card, index) => {
                        const title = card.querySelector('.quiz-card-title');
                        const originalText = title ? (title.textContent || title.innerText).trim() : '';

                        if (!originalText) return;

                        // üéØ SMART TEXT ANALYSIS - Ph√¢n t√≠ch th√¥ng minh ƒë·ªô d√†i text
                        const analyzeTextComplexity = (text, screenWidth) => {
                            // T√≠nh to√°n font size v√† card width d·ª±a tr√™n thi·∫øt b·ªã
                            let fontSize, cardWidth, baseHeight;

                            if (screenWidth <= 360) {
                                fontSize = 14;
                                cardWidth = 260;
                                baseHeight = 320;
                            } else if (screenWidth <= 414) {
                                fontSize = 15;
                                cardWidth = 280;
                                baseHeight = 340;
                            } else if (screenWidth <= 768) {
                                fontSize = 16;
                                cardWidth = 320;
                                baseHeight = 380;
                            } else {
                                fontSize = 17;
                                cardWidth = 340;
                                baseHeight = 390;
                            }

                            // T√≠nh to√°n ch√≠nh x√°c s·ªë k√Ω t·ª± tr√™n m·ªói d√≤ng
                            const charWidth = fontSize * 0.55; // ∆Ø·ªõc t√≠nh width c·ªßa 1 k√Ω t·ª±
                            const availableWidth = cardWidth - 40; // Tr·ª´ padding
                            const charsPerLine = Math.floor(availableWidth / charWidth);

                            // T√≠nh s·ªë d√≤ng th·ª±c t·∫ø c·∫ßn thi·∫øt
                            const words = text.split(' ');
                            let currentLineLength = 0;
                            let lines = 1;

                            words.forEach(word => {
                                if (currentLineLength + word.length + 1 > charsPerLine) {
                                    lines++;
                                    currentLineLength = word.length;
                                } else {
                                    currentLineLength += word.length + 1;
                                }
                            });

                            // Gi·ªõi h·∫°n t·ªëi ƒëa 6 d√≤ng ƒë·ªÉ kh√¥ng qu√° d√†i
                            const maxLines = Math.min(lines, 6);

                            // T√≠nh chi·ªÅu cao title
                            const lineHeight = fontSize * 1.3;
                            const titleHeight = maxLines * lineHeight + 8; // Th√™m margin

                            // T√≠nh t·ªïng chi·ªÅu cao card
                            const headerHeight = 45; // Category + stats
                            const metaHeight = 65;    // User info + questions
                            const actionsHeight = 50; // Buttons
                            const padding = 40;       // Top + bottom padding

                            const totalCardHeight = Math.max(
                                baseHeight,
                                headerHeight + titleHeight + metaHeight + actionsHeight + padding
                            );

                            return {
                                cardHeight: totalCardHeight,
                                titleHeight: titleHeight,
                                fontSize: fontSize,
                                lines: maxLines,
                                isLongText: lines > 2,
                                complexity: text.length > 50 ? 'high' : text.length > 30 ? 'medium' : 'low'
                            };
                        };

                        const analysis = analyzeTextComplexity(originalText, screenWidth);

                        // üé® APPLY DYNAMIC STYLING - √Åp d·ª•ng style ƒë·ªông
                        card.style.height = `${analysis.cardHeight}px`;
                        card.style.minHeight = `${analysis.cardHeight}px`;

                        if (title) {
                            // Reset t·∫•t c·∫£ styles tr∆∞·ªõc
                            title.style.fontSize = `${analysis.fontSize}px`;
                            title.style.lineHeight = '1.3';
                            title.style.height = 'auto';
                            title.style.maxHeight = `${analysis.titleHeight}px`;
                            title.style.minHeight = `${analysis.fontSize * 1.3 * 2}px`; // T·ªëi thi·ªÉu 2 d√≤ng
                            title.style.webkitLineClamp = analysis.lines.toString();
                            title.style.lineClamp = analysis.lines.toString();
                            title.style.display = '-webkit-box';
                            title.style.webkitBoxOrient = 'vertical';
                            title.style.overflow = 'hidden';
                            title.style.wordBreak = 'break-word';
                            title.style.hyphens = 'auto';

                            // Th√™m visual indicator cho text d√†i
                            if (analysis.isLongText) {
                                title.setAttribute('title', `üìñ ${originalText}`);
                                title.style.cursor = 'help';
                                card.classList.add('quiz-card-long-text');
                            } else {
                                card.classList.remove('quiz-card-long-text');
                            }
                        }

                        // üîç ENSURE BUTTON VISIBILITY - ƒê·∫£m b·∫£o n√∫t lu√¥n hi·ªÉn th·ªã
                        const actions = card.querySelector('.quiz-card-practice-action, .quiz-card-actions');
                        if (actions) {
                            actions.style.marginTop = 'auto';
                            actions.style.flexShrink = '0';
                            actions.style.position = 'relative';
                            actions.style.zIndex = '10';
                        }

                        console.log(`üìè Card ${index + 1}: "${originalText.substring(0, 25)}..." -> ${analysis.cardHeight}px (${analysis.lines} lines, ${analysis.complexity} complexity)`);
                    });

                    // üì¶ ADJUST CONTAINER HEIGHT - ƒêi·ªÅu ch·ªânh chi·ªÅu cao container
                    const cardHeights = Array.from(cards).map(card => {
                        const height = parseInt(card.style.height) || parseInt(getComputedStyle(card).height) || 390;
                        return height;
                    });

                    const maxCardHeight = Math.max(...cardHeights);
                    const containerPadding = 40;
                    const requiredContainerHeight = maxCardHeight + containerPadding;

                    const containers = document.querySelectorAll('.quiz-container-wrapper');
                    containers.forEach(container => {
                        container.style.height = `${requiredContainerHeight}px`;
                        container.style.minHeight = `${requiredContainerHeight}px`;
                    });

                    console.log(`üì¶ Container optimized: ${requiredContainerHeight}px (max card: ${maxCardHeight}px, ${cards.length} cards)`);

                    // üéØ PERFORMANCE OPTIMIZATION - Trigger reflow once
                    cards[0]?.offsetHeight; // Force reflow
                };

                // √Åp d·ª•ng layout th√¥ng minh
                optimizeContentAwareLayout();

                console.log(`üéØ Applied adaptive layout: ${cardWidth}x${cardHeight}px cards, ${containerHeight}px container`);
            };

            // üåê EXPOSE FUNCTIONS TO GLOBAL SCOPE for external access
            window.optimizeContentAwareLayout = optimizeContentAwareLayout;
            window.initAdaptiveLayout = initAdaptiveLayout;

            // Kh·ªüi t·∫°o adaptive layout
            initAdaptiveLayout();

            // L·∫Øng nghe thay ƒë·ªïi k√≠ch th∆∞·ªõc m√†n h√¨nh
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    initAdaptiveLayout();
                }, 250);
            });

            // L·∫Øng nghe thay ƒë·ªïi orientation
            window.addEventListener('orientationchange', () => {
                setTimeout(() => {
                    initAdaptiveLayout();
                }, 500);
            });

            // üß™ Add sample quiz data if no quizzes are loaded after 3 seconds
            setTimeout(() => {
                const trendingContainer = document.getElementById('trending-quizzes');
                const latestContainer = document.getElementById('latest-quizzes');

                if (trendingContainer && trendingContainer.querySelector('.quiz-loading')) {
                    console.log('üß™ Loading sample quiz data...');

                    const sampleQuizHTML = `
                        <div class="quiz-card-horizontal" data-quiz-id="sample1">
                            <div class="quiz-card-header">
                                <div class="quiz-card-category">
                                    <i class="fas fa-calculator"></i>
                                    To√°n cao c·∫•p
                                </div>
                                <div class="quiz-card-stats">
                                    <div class="quiz-card-stat">
                                        <i class="fas fa-eye"></i>
                                        <span>125</span>
                                    </div>
                                    <div class="quiz-card-stat">
                                        <i class="fas fa-fire"></i>
                                        <span>89</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="quiz-card-content">
                                <div class="quiz-card-title">Gi·∫£i t√≠ch 1 - Gi·ªõi h·∫°n v√† Li√™n t·ª•c</div>
                                
                                <div class="quiz-card-meta">
                                    <div class="quiz-card-meta-row">
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-user"></i>
                                            <span>Nguy·ªÖn VƒÉn A</span>
                                        </div>
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-question-circle"></i>
                                            <span>25 c√¢u</span>
                                        </div>
                                    </div>
                                    <div class="quiz-card-meta-row">
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-clock"></i>
                                            <span>2 gi·ªù tr∆∞·ªõc</span>
                                        </div>
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-calendar"></i>
                                            <span>03/01/2026</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="quiz-card-actions">
                                    <button class="btn-quiz-action btn-quiz-primary">
                                        <i class="fas fa-play"></i>
                                        <span>V√†o thi</span>
                                    </button>
                                    <button class="btn-quiz-action btn-quiz-secondary">
                                        <i class="fas fa-info-circle"></i>
                                        <span>Chi ti·∫øt</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="quiz-card-horizontal" data-quiz-id="sample2">
                            <div class="quiz-card-header">
                                <div class="quiz-card-category">
                                    <i class="fas fa-code"></i>
                                    C√¥ng ngh·ªá th√¥ng tin
                                </div>
                                <div class="quiz-card-stats">
                                    <div class="quiz-card-stat">
                                        <i class="fas fa-eye"></i>
                                        <span>98</span>
                                    </div>
                                    <div class="quiz-card-stat">
                                        <i class="fas fa-fire"></i>
                                        <span>67</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="quiz-card-content">
                                <div class="quiz-card-title">L·∫≠p tr√¨nh h∆∞·ªõng ƒë·ªëi t∆∞·ª£ng v·ªõi Java</div>
                                
                                <div class="quiz-card-meta">
                                    <div class="quiz-card-meta-row">
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-user"></i>
                                            <span>Tr·∫ßn Th·ªã B</span>
                                        </div>
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-question-circle"></i>
                                            <span>30 c√¢u</span>
                                        </div>
                                    </div>
                                    <div class="quiz-card-meta-row">
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-clock"></i>
                                            <span>4 gi·ªù tr∆∞·ªõc</span>
                                        </div>
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-calendar"></i>
                                            <span>03/01/2026</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="quiz-card-actions">
                                    <button class="btn-quiz-action btn-quiz-primary">
                                        <i class="fas fa-play"></i>
                                        <span>V√†o thi</span>
                                    </button>
                                    <button class="btn-quiz-action btn-quiz-secondary">
                                        <i class="fas fa-info-circle"></i>
                                        <span>Chi ti·∫øt</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="quiz-card-horizontal" data-quiz-id="sample3">
                            <div class="quiz-card-header">
                                <div class="quiz-card-category">
                                    <i class="fas fa-chart-line"></i>
                                    Kinh t·∫ø h·ªçc
                                </div>
                                <div class="quiz-card-stats">
                                    <div class="quiz-card-stat">
                                        <i class="fas fa-eye"></i>
                                        <span>76</span>
                                    </div>
                                    <div class="quiz-card-stat">
                                        <i class="fas fa-fire"></i>
                                        <span>45</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="quiz-card-content">
                                <div class="quiz-card-title">Kinh t·∫ø vi m√¥ - C∆° b·∫£n</div>
                                
                                <div class="quiz-card-meta">
                                    <div class="quiz-card-meta-row">
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-user"></i>
                                            <span>L√™ VƒÉn C</span>
                                        </div>
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-question-circle"></i>
                                            <span>20 c√¢u</span>
                                        </div>
                                    </div>
                                    <div class="quiz-card-meta-row">
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-clock"></i>
                                            <span>6 gi·ªù tr∆∞·ªõc</span>
                                        </div>
                                        <div class="quiz-card-meta-item">
                                            <i class="fas fa-calendar"></i>
                                            <span>02/01/2026</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="quiz-card-actions">
                                    <button class="btn-quiz-action btn-quiz-primary">
                                        <i class="fas fa-play"></i>
                                        <span>V√†o thi</span>
                                    </button>
                                    <button class="btn-quiz-action btn-quiz-secondary">
                                        <i class="fas fa-info-circle"></i>
                                        <span>Chi ti·∫øt</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;

                    trendingContainer.innerHTML = sampleQuizHTML;
                    latestContainer.innerHTML = sampleQuizHTML;

                    // Apply fixes to new cards
                    const newCards = document.querySelectorAll('.quiz-card-horizontal');
                    newCards.forEach(card => {
                        card.style.flex = '0 0 340px';
                        card.style.width = '340px';
                        card.style.height = '390px';
                        card.style.minWidth = '340px';
                        card.style.maxWidth = '340px';
                    });

                    console.log('‚úÖ Loaded sample quiz data');
                }
            }, 3000);
        });

        // üîß Apply fixes when new content is loaded
        const observer = new MutationObserver(function (mutations) {
            mutations.forEach(function (mutation) {
                if (mutation.type === 'childList') {
                    const containers = document.querySelectorAll('#trending-quizzes, #latest-quizzes');
                    containers.forEach(container => {
                        if (container && container.children.length > 0) {
                            container.style.display = 'flex';
                            container.style.flexDirection = 'row';
                            container.style.flexWrap = 'nowrap';
                            container.style.overflowX = 'auto';
                            container.style.overflowY = 'hidden';

                            // Fix cards
                            const cards = container.querySelectorAll('.quiz-card-horizontal');
                            cards.forEach(card => {
                                card.style.flex = '0 0 340px';
                                card.style.width = '340px';
                                card.style.height = '390px';
                            });
                        }
                    });
                }
            });
        });

        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    </script>

    <!-- ü¶åüéÖ INSTANT GIF INITIALIZATION - NO WAITING -->
    <script>
        // Kh·ªüi t·∫°o ngay l·∫≠p t·ª©c, kh√¥ng ƒë·ª£i DOM
        (function initGifsInstantly() {
            // H√†m init s·∫Ω ch·∫°y ngay khi script ƒë∆∞·ª£c parse
            function tryInit() {
                const reindeerGif = document.querySelector('.reindeer-on-card');
                const santaGif = document.querySelector('.santa-on-card');

                if (reindeerGif) {
                    reindeerGif.style.display = 'block';
                    reindeerGif.style.visibility = 'visible';
                    reindeerGif.style.opacity = '1';
                    reindeerGif.style.animation = 'reindeerContinuousJump 1.5s ease-in-out infinite';
                    console.log('ü¶å Reindeer loaded!');
                }

                if (santaGif) {
                    santaGif.style.display = 'block';
                    santaGif.style.visibility = 'visible';
                    santaGif.style.opacity = '1';
                    santaGif.style.animation = 'santaContinuousJump 1.8s ease-in-out infinite';
                    console.log('üéÖ Santa loaded!');
                }

                // N·∫øu ch∆∞a t√¨m th·∫•y, th·ª≠ l·∫°i sau 10ms
                if (!reindeerGif || !santaGif) {
                    setTimeout(tryInit, 10);
                }
            }

            // B·∫Øt ƒë·∫ßu init ngay
            tryInit();
        })();
    </script>

    <!-- üé† USER QUIZ CAROUSEL 3D JAVASCRIPT -->
    <script>
        // Quiz Carousel 3D Controller
        class QuizCarousel3D {
            constructor() {
                this.currentIndex = 0;
                this.isAnimating = false;
                this.userQuizzes = [];
                this.init();
            }

            init() {
                this.loadUserQuizzes();
                this.setupElements();
                this.renderCarousel();
            }

            loadUserQuizzes() {
                try {
                    // Debug: Check all localStorage keys
                    console.log('üîç All localStorage keys:', Object.keys(localStorage));

                    // Try different possible keys
                    const possibleKeys = ['quizzes', 'quiz', 'userQuizzes', 'savedQuizzes'];
                    let foundData = null;
                    let usedKey = null;

                    for (const key of possibleKeys) {
                        const data = localStorage.getItem(key);
                        if (data) {
                            console.log(`üîç Found data in key '${key}':`, data);
                            foundData = data;
                            usedKey = key;
                            break;
                        }
                    }

                    if (!foundData) {
                        // Check if there's any quiz-related data
                        for (const key of Object.keys(localStorage)) {
                            if (key.toLowerCase().includes('quiz')) {
                                const data = localStorage.getItem(key);
                                console.log(`üîç Found quiz-related key '${key}':`, data);
                                foundData = data;
                                usedKey = key;
                                break;
                            }
                        }
                    }

                    if (foundData) {
                        console.log(`üîç Using data from key '${usedKey}'`);
                        const allQuizzes = JSON.parse(foundData);
                        console.log('üîç Parsed quizzes:', allQuizzes);
                        console.log('üîç Type of parsed data:', typeof allQuizzes);
                        console.log('üîç Is array:', Array.isArray(allQuizzes));

                        // Handle different data structures
                        let quizArray = [];
                        if (Array.isArray(allQuizzes)) {
                            quizArray = allQuizzes;
                        } else if (typeof allQuizzes === 'object' && allQuizzes !== null) {
                            // If it's an object, try to extract array
                            if (allQuizzes.quizzes && Array.isArray(allQuizzes.quizzes)) {
                                quizArray = allQuizzes.quizzes;
                            } else {
                                // Convert object to array
                                quizArray = Object.values(allQuizzes);
                            }
                        }

                        console.log('üîç Final quiz array:', quizArray);
                        console.log('üîç Number of quizzes:', quizArray.length);

                        this.userQuizzes = quizArray.map((quiz, index) => {
                            console.log(`üîç Processing quiz ${index}:`, quiz);

                            // Handle different property names
                            const title = quiz.title || quiz.name || quiz.quizTitle || `Quiz ${index + 1}`;
                            const description = quiz.description || quiz.desc || quiz.subject || 'Kh√¥ng c√≥ m√¥ t·∫£';
                            const questions = quiz.questions || quiz.items || quiz.data || [];
                            const questionCount = Array.isArray(questions) ? questions.length :
                                (typeof questions === 'number' ? questions : 0);

                            const result = {
                                id: quiz.id || quiz.quizId || index,
                                name: title,
                                subject: description,
                                questions: questionCount,
                                date: quiz.createdAt ? new Date(quiz.createdAt).toLocaleDateString('vi-VN') :
                                    quiz.date || new Date().toLocaleDateString('vi-VN'),
                                icon: this.getQuizIcon(title, index)
                            };

                            console.log(`üîç Mapped quiz ${index}:`, result);
                            return result;
                        });

                        console.log('üîç Final userQuizzes:', this.userQuizzes);
                    } else {
                        console.log('üîç No quiz data found in localStorage');
                        this.userQuizzes = [];
                    }
                } catch (error) {
                    console.error('‚ùå Error loading user quizzes:', error);
                    this.userQuizzes = [];
                }
            }

            getQuizIcon(title, index) {
                const icons = ['üìö', 'üíª', 'üéØ', 'üî¨', 'üåç', 'üìñ', 'üé®', '‚öóÔ∏è', 'üßÆ', 'üéµ'];

                // Ch·ªçn icon d·ª±a tr√™n t·ª´ kh√≥a trong title
                const titleLower = title.toLowerCase();
                if (titleLower.includes('tin h·ªçc') || titleLower.includes('computer')) return 'üíª';
                if (titleLower.includes('to√°n') || titleLower.includes('math')) return 'üßÆ';
                if (titleLower.includes('khoa h·ªçc') || titleLower.includes('science')) return 'üî¨';
                if (titleLower.includes('ƒë·ªãa l√Ω') || titleLower.includes('geography')) return 'üåç';
                if (titleLower.includes('vƒÉn h·ªçc') || titleLower.includes('literature')) return 'üìñ';
                if (titleLower.includes('ngh·ªá thu·∫≠t') || titleLower.includes('art')) return 'üé®';
                if (titleLower.includes('h√≥a h·ªçc') || titleLower.includes('chemistry')) return '‚öóÔ∏è';
                if (titleLower.includes('√¢m nh·∫°c') || titleLower.includes('music')) return 'üéµ';

                // Fallback: ch·ªçn icon theo index
                return icons[index % icons.length];
            }

            setupElements() {
                this.emptyState = document.getElementById('empty-state-3d');
                this.carouselMain = document.getElementById('carousel-main-section');
                this.carouselControls = document.getElementById('carousel-controls-section');
                this.carouselTrack = document.getElementById('carousel-3d-track');
                this.dotsContainer = document.getElementById('dots-3d-container');
                this.quizName = document.querySelector('.quiz-name-3d');
                this.quizSubject = document.querySelector('.quiz-subject-3d');
            }

            renderCarousel() {
                console.log('üé† Debug - Rendering carousel with', this.userQuizzes.length, 'quizzes');

                if (this.userQuizzes.length === 0) {
                    console.log('üé† Debug - Showing empty state');
                    this.showEmptyState();
                } else {
                    console.log('üé† Debug - Showing carousel with quizzes');
                    this.showCarousel();
                    this.createQuizCards();
                    this.createDots();
                    this.bindEvents();
                    this.updateCarousel(0);
                }
            }

            showEmptyState() {
                this.emptyState.style.display = 'block';
                this.carouselMain.style.display = 'none';
                this.carouselControls.style.display = 'none';
            }

            showCarousel() {
                this.emptyState.style.display = 'none';
                this.carouselMain.style.display = 'flex';
                this.carouselControls.style.display = 'flex';
            }

            createQuizCards() {
                this.carouselTrack.innerHTML = '';

                this.userQuizzes.forEach((quiz, index) => {
                    const card = document.createElement('div');
                    card.className = `quiz-card-3d ${index === 0 ? 'center' : 'hidden'}`;
                    card.setAttribute('data-index', index);
                    card.setAttribute('data-quiz-id', quiz.id);

                    card.innerHTML = `
                        <div class="quiz-card-3d-header">
                            <div class="quiz-card-3d-icon">${quiz.icon}</div>
                        </div>
                        <div class="quiz-card-3d-content">
                            <h3 class="quiz-card-3d-title">${quiz.name}</h3>
                            <p class="quiz-card-3d-description">${quiz.subject}</p>
                            <div class="quiz-card-3d-meta">
                                <span class="quiz-meta-item-3d">üìä ${quiz.questions} c√¢u</span>
                                <span class="quiz-meta-item-3d">üìÖ ${quiz.date}</span>
                            </div>
                            <button class="quiz-start-btn-3d" onclick="quizCarousel3D.startQuiz(${quiz.id})">
                                <i class="fas fa-play"></i>
                                V√†o l√†m thi
                            </button>
                        </div>
                    `;

                    this.carouselTrack.appendChild(card);
                });
            }

            createDots() {
                this.dotsContainer.innerHTML = '';

                this.userQuizzes.forEach((_, index) => {
                    const dot = document.createElement('div');
                    dot.className = `dot-3d ${index === 0 ? 'active' : ''}`;
                    dot.setAttribute('data-index', index);
                    this.dotsContainer.appendChild(dot);
                });
            }

            bindEvents() {
                this.cards = document.querySelectorAll(".quiz-card-3d");
                this.dots = document.querySelectorAll(".dot-3d");
                this.upArrows = document.querySelectorAll(".nav-arrow.up");
                this.downArrows = document.querySelectorAll(".nav-arrow.down");

                if (!this.cards.length) return;

                // Arrow buttons
                this.upArrows.forEach(arrow => {
                    arrow.addEventListener("click", () => {
                        this.updateCarousel(this.currentIndex - 1);
                    });
                });

                this.downArrows.forEach(arrow => {
                    arrow.addEventListener("click", () => {
                        this.updateCarousel(this.currentIndex + 1);
                    });
                });

                // Dots
                this.dots.forEach((dot, i) => {
                    dot.addEventListener("click", () => {
                        this.updateCarousel(i);
                    });
                });

                // Cards
                this.cards.forEach((card, i) => {
                    card.addEventListener("click", () => {
                        this.updateCarousel(i);
                    });
                });

                // Keyboard support
                document.addEventListener("keydown", (e) => {
                    if (e.key === "ArrowUp") {
                        e.preventDefault();
                        this.updateCarousel(this.currentIndex - 1);
                    } else if (e.key === "ArrowDown") {
                        e.preventDefault();
                        this.updateCarousel(this.currentIndex + 1);
                    }
                });

                // Touch/Swipe support
                let touchStartY = 0;
                let touchEndY = 0;

                document.addEventListener("touchstart", (e) => {
                    touchStartY = e.changedTouches[0].screenY;
                });

                document.addEventListener("touchend", (e) => {
                    touchEndY = e.changedTouches[0].screenY;
                    this.handleSwipe(touchStartY, touchEndY);
                });
            }

            handleSwipe(startY, endY) {
                const swipeThreshold = 50;
                const diff = startY - endY;

                if (Math.abs(diff) > swipeThreshold) {
                    if (diff > 0) {
                        this.updateCarousel(this.currentIndex + 1);
                    } else {
                        this.updateCarousel(this.currentIndex - 1);
                    }
                }
            }

            updateCarousel(newIndex) {
                if (this.isAnimating || !this.cards.length) return;
                this.isAnimating = true;

                this.currentIndex = (newIndex + this.cards.length) % this.cards.length;

                this.cards.forEach((card, i) => {
                    const offset = (i - this.currentIndex + this.cards.length) % this.cards.length;

                    card.classList.remove(
                        "center",
                        "up-1",
                        "up-2",
                        "down-1",
                        "down-2",
                        "hidden"
                    );

                    if (offset === 0) {
                        card.classList.add("center");
                    } else if (offset === 1) {
                        card.classList.add("down-1");
                    } else if (offset === 2) {
                        card.classList.add("down-2");
                    } else if (offset === this.cards.length - 1) {
                        card.classList.add("up-1");
                    } else if (offset === this.cards.length - 2) {
                        card.classList.add("up-2");
                    } else {
                        card.classList.add("hidden");
                    }
                });

                // Update dots
                this.dots.forEach((dot, i) => {
                    dot.classList.toggle("active", i === this.currentIndex);
                });

                // Update info with animation
                if (this.quizName && this.quizSubject && this.userQuizzes[this.currentIndex]) {
                    this.quizName.style.opacity = "0";
                    this.quizSubject.style.opacity = "0";

                    setTimeout(() => {
                        this.quizName.textContent = this.userQuizzes[this.currentIndex].name;
                        this.quizSubject.textContent = this.userQuizzes[this.currentIndex].subject;
                        this.quizName.style.opacity = "1";
                        this.quizSubject.style.opacity = "1";
                    }, 300);
                }

                setTimeout(() => {
                    this.isAnimating = false;
                }, 800);
            }

            startQuiz(quizId) {
                // Chuy·ªÉn ƒë·∫øn tab l√†m b√†i v√† ch·ªçn quiz
                const quizSelector = document.getElementById('quiz-selector');
                if (quizSelector) {
                    // T√¨m option c√≥ value t∆∞∆°ng ·ª©ng v·ªõi quiz ID
                    const option = Array.from(quizSelector.options).find(opt =>
                        opt.value.includes(quizId) || opt.textContent.includes(this.userQuizzes[this.currentIndex].name)
                    );
                    if (option) {
                        quizSelector.value = option.value;
                    }
                }

                // Chuy·ªÉn ƒë·∫øn tab quiz
                const quizTab = document.querySelector('[data-tab="quiz"]');
                if (quizTab) {
                    quizTab.click();
                }
            }

            // Method ƒë·ªÉ refresh carousel khi c√≥ quiz m·ªõi
            refresh() {
                console.log('üîÑ Debug - Refreshing carousel...');
                this.loadUserQuizzes();
                this.renderCarousel();
            }

            // Method ƒë·ªÉ force refresh t·ª´ console (for debugging)
            forceRefresh() {
                console.log('üîÑ Force refresh carousel');
                this.refresh();
            }
        }

        // Initialize carousel when DOM is ready
        let quizCarousel3D;
        document.addEventListener('DOMContentLoaded', function () {
            // Wait a bit for the DOM to be fully rendered
            setTimeout(() => {
                quizCarousel3D = new QuizCarousel3D();
                console.log('üé† Quiz Carousel 3D initialized');

                // Make it globally accessible for debugging
                window.quizCarousel3D = quizCarousel3D;

                // Listen for quiz updates to refresh carousel
                window.addEventListener('quizUpdated', () => {
                    console.log('üì¢ Quiz updated event received');
                    if (quizCarousel3D) {
                        quizCarousel3D.refresh();
                    }
                });

                // Listen for storage changes (when quiz is created/updated)
                window.addEventListener('storage', (e) => {
                    if (e.key === 'quizzes') {
                        console.log('üì¢ Storage change detected for quizzes');
                        if (quizCarousel3D) {
                            quizCarousel3D.refresh();
                        }
                    }
                });

                // Also listen for custom events
                document.addEventListener('quizCreated', () => {
                    console.log('üì¢ Quiz created event received');
                    if (quizCarousel3D) {
                        setTimeout(() => quizCarousel3D.refresh(), 100);
                    }
                });

                document.addEventListener('quizDeleted', () => {
                    console.log('üì¢ Quiz deleted event received');
                    if (quizCarousel3D) {
                        setTimeout(() => quizCarousel3D.refresh(), 100);
                    }
                });

                // Refresh carousel when home tab is activated
                const homeTab = document.querySelector('[data-tab="home"]');
                if (homeTab) {
                    homeTab.addEventListener('click', () => {
                        console.log('üì¢ Home tab clicked - refreshing carousel');
                        setTimeout(() => {
                            if (quizCarousel3D) {
                                quizCarousel3D.refresh();
                            }
                        }, 200);
                    });
                }

                // Auto refresh every 5 seconds (for debugging)
                setInterval(() => {
                    if (quizCarousel3D && document.querySelector('#home-tab.active')) {
                        console.log('üîÑ Auto refresh carousel (debug mode)');
                        quizCarousel3D.refresh();
                    }
                }, 5000);
            }, 100);
        });
    </script>

    <!-- üåê EXPLORE QUIZ CAROUSEL 3D JAVASCRIPT -->
    <script>
        // Explore Quiz Carousel 3D Controller
        class ExploreQuizCarousel3D {
            constructor() {
                this.currentIndex = 0;
                this.isAnimating = false;
                this.latestQuizzes = [];
                this.init();
            }

            init() {
                this.setupElements();
                this.loadLatestQuizzes();
            }

            setupElements() {
                this.loadingState = document.getElementById('latest-loading-state');
                this.carouselMain = document.getElementById('latest-carousel-main-section');
                this.carouselControls = document.getElementById('latest-carousel-controls-section');
                this.carouselTrack = document.getElementById('latest-carousel-3d-track');
                this.dotsContainer = document.querySelector('#latest-carousel-controls-section .explore-dots-horizontal');
                this.quizName = document.querySelector('#latest-carousel-controls-section .explore-quiz-name-3d');
                this.quizSubject = document.querySelector('#latest-carousel-controls-section .explore-quiz-subject-3d');
            }

            async loadLatestQuizzes() {
                try {
                    console.log('üåê Loading latest quizzes for explore carousel...');

                    // Show loading state
                    this.showLoadingState();

                    // Get quizzes from exploreQuizManager if available
                    let foundQuizzes = [];

                    if (window.exploreQuizManager) {
                        console.log('üåê ExploreQuizManager found, checking properties:', Object.keys(window.exploreQuizManager));

                        // Try different possible properties
                        const possibleSources = [
                            'sharedQuizzes',
                            'quizzes',
                            'allQuizzes',
                            'communityQuizzes',
                            'latestQuizzes',
                            'trendingQuizzes',
                            'cachedQuizzes',
                            'loadedQuizzes'
                        ];

                        for (const source of possibleSources) {
                            if (window.exploreQuizManager[source] && Array.isArray(window.exploreQuizManager[source]) && window.exploreQuizManager[source].length > 0) {
                                foundQuizzes = window.exploreQuizManager[source];
                                console.log(`üåê Found ${foundQuizzes.length} quizzes in ${source}:`, foundQuizzes);
                                break;
                            }
                        }

                        // Try to access via methods if properties don't work
                        if (foundQuizzes.length === 0) {
                            console.log('üåê No quizzes found in properties, trying methods...');

                            // Try to get cached data
                            if (typeof window.exploreQuizManager.getCachedQuizzes === 'function') {
                                const cached = window.exploreQuizManager.getCachedQuizzes();
                                if (cached && cached.length > 0) {
                                    foundQuizzes = cached;
                                    console.log(`üåê Found ${foundQuizzes.length} cached quizzes`);
                                }
                            }

                            // Try to load fresh data
                            if (foundQuizzes.length === 0 && typeof window.exploreQuizManager.loadSharedQuizzes === 'function') {
                                console.log('üåê Calling loadSharedQuizzes...');
                                await window.exploreQuizManager.loadSharedQuizzes();

                                // Check again after loading
                                for (const source of possibleSources) {
                                    if (window.exploreQuizManager[source] && Array.isArray(window.exploreQuizManager[source]) && window.exploreQuizManager[source].length > 0) {
                                        foundQuizzes = window.exploreQuizManager[source];
                                        console.log(`üåê After loading, found ${foundQuizzes.length} quizzes in ${source}`);
                                        break;
                                    }
                                }
                            }
                        }
                    }

                    // Method 2: Try to extract from trending section
                    if (foundQuizzes.length === 0) {
                        foundQuizzes = this.extractFromTrendingSection();
                    }

                    // Method 3: Try to extract from any quiz cards in DOM
                    if (foundQuizzes.length === 0) {
                        foundQuizzes = this.extractFromDOM();
                    }

                    // Method 3: Create demo data as last resort (for testing)
                    if (foundQuizzes.length === 0) {
                        console.log('üåê No quizzes found anywhere, creating demo data for testing...');
                        foundQuizzes = [
                            {
                                id: 'demo-1',
                                title: 'Tin H·ªçc C∆° B·∫£n',
                                name: 'Tin H·ªçc C∆° B·∫£n',
                                description: 'C√¢u h·ªèi thi ch·ª©ng ch·ªâ tin h·ªçc',
                                subject: 'C√¢u h·ªèi thi ch·ª©ng ch·ªâ tin h·ªçc',
                                questions: 25,
                                questionCount: 25,
                                date: new Date().toLocaleDateString('vi-VN'),
                                author: 'C·ªông ƒë·ªìng',
                                views: 150,
                                attempts: 45,
                                createdAt: new Date().toISOString()
                            },
                            {
                                id: 'demo-2',
                                title: 'Th∆∞∆°ng M·∫°i ƒêi·ªán T·ª≠',
                                name: 'Th∆∞∆°ng M·∫°i ƒêi·ªán T·ª≠',
                                description: 'C√¢u tr·∫Øc nghi·ªám v·ªÅ th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠',
                                subject: 'C√¢u tr·∫Øc nghi·ªám v·ªÅ th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠',
                                questions: 20,
                                questionCount: 20,
                                date: new Date().toLocaleDateString('vi-VN'),
                                author: 'C·ªông ƒë·ªìng',
                                views: 230,
                                attempts: 67,
                                createdAt: new Date().toISOString()
                            },
                            {
                                id: 'demo-3',
                                title: 'L·∫≠p Tr√¨nh Mobile',
                                name: 'L·∫≠p Tr√¨nh Mobile',
                                description: 'Tr·∫Øc nghi·ªám v·ªÅ l·∫≠p tr√¨nh ·ª©ng d·ª•ng mobile',
                                subject: 'Tr·∫Øc nghi·ªám v·ªÅ l·∫≠p tr√¨nh ·ª©ng d·ª•ng mobile',
                                questions: 30,
                                questionCount: 30,
                                date: new Date().toLocaleDateString('vi-VN'),
                                author: 'C·ªông ƒë·ªìng',
                                views: 189,
                                attempts: 52,
                                createdAt: new Date().toISOString()
                            }
                        ];
                    }

                    if (foundQuizzes.length > 0) {
                        console.log('üåê Processing found quizzes:', foundQuizzes);

                        // Get latest 10 quizzes
                        this.latestQuizzes = foundQuizzes
                            .sort((a, b) => new Date(b.createdAt || b.date || b.created_at) - new Date(a.createdAt || a.date || a.created_at))
                            .slice(0, 10)
                            .map((quiz, index) => ({
                                id: quiz.id || quiz.quiz_id || index,
                                name: quiz.title || quiz.name || quiz.quiz_title || `Quiz ${index + 1}`,
                                subject: quiz.description || quiz.subject || quiz.quiz_description || 'Kh√¥ng c√≥ m√¥ t·∫£',
                                questions: quiz.questions?.length || quiz.questionCount || quiz.question_count || quiz.totalQuestions || 0,
                                date: quiz.createdAt ? new Date(quiz.createdAt).toLocaleDateString('vi-VN') :
                                    quiz.date ? new Date(quiz.date).toLocaleDateString('vi-VN') :
                                        quiz.created_at ? new Date(quiz.created_at).toLocaleDateString('vi-VN') :
                                            new Date().toLocaleDateString('vi-VN'),
                                author: quiz.author || quiz.creator || quiz.user_name || quiz.userName || '·∫®n danh',
                                views: quiz.views || 0,
                                attempts: quiz.attempts || 0,
                                icon: this.getQuizIcon(quiz.title || quiz.name || quiz.quiz_title, index)
                            }));
                    } else {
                        // No shared quizzes available - show empty state
                        console.log('üåê No shared quizzes found, showing empty state');
                        this.latestQuizzes = [];
                    }

                    console.log('üåê Latest quizzes loaded:', this.latestQuizzes);

                    // Render carousel
                    setTimeout(() => {
                        this.renderCarousel();
                    }, 500);

                } catch (error) {
                    console.error('‚ùå Error loading latest quizzes:', error);
                    this.latestQuizzes = [];
                    this.renderCarousel();
                }
            }

            getQuizIcon(title, index) {
                const icons = ['üìö', 'üíª', 'üéØ', 'üî¨', 'üåç', 'üìñ', 'üé®', '‚öóÔ∏è', 'üßÆ', 'üéµ', 'üèõÔ∏è', 'üá¨üáß', 'üáªüá≥'];

                if (!title) return icons[index % icons.length];

                const titleLower = title.toLowerCase();
                if (titleLower.includes('to√°n') || titleLower.includes('math')) return 'üßÆ';
                if (titleLower.includes('ti·∫øng anh') || titleLower.includes('english')) return 'üá¨üáß';
                if (titleLower.includes('l·ªãch s·ª≠') || titleLower.includes('history')) return 'üèõÔ∏è';
                if (titleLower.includes('tin h·ªçc') || titleLower.includes('computer')) return 'üíª';
                if (titleLower.includes('khoa h·ªçc') || titleLower.includes('science')) return 'üî¨';
                if (titleLower.includes('ƒë·ªãa l√Ω') || titleLower.includes('geography')) return 'üåç';
                if (titleLower.includes('vƒÉn h·ªçc') || titleLower.includes('literature')) return 'üìñ';
                if (titleLower.includes('ngh·ªá thu·∫≠t') || titleLower.includes('art')) return 'üé®';
                if (titleLower.includes('h√≥a h·ªçc') || titleLower.includes('chemistry')) return '‚öóÔ∏è';
                if (titleLower.includes('√¢m nh·∫°c') || titleLower.includes('music')) return 'üéµ';

                return icons[index % icons.length];
            }

            showLoadingState() {
                if (this.loadingState) this.loadingState.style.display = 'flex';
                if (this.carouselMain) this.carouselMain.style.display = 'none';
                if (this.carouselControls) this.carouselControls.style.display = 'none';
            }

            showCarousel() {
                if (this.loadingState) this.loadingState.style.display = 'none';
                if (this.carouselMain) this.carouselMain.style.display = 'flex';
                // Hide controls section - info panel not needed
                // if (this.carouselControls) this.carouselControls.style.display = 'flex';
            }

            renderCarousel() {
                console.log('üåê Rendering explore carousel with', this.latestQuizzes.length, 'quizzes');

                if (this.latestQuizzes.length === 0) {
                    this.showLoadingState();
                    return;
                }

                this.showCarousel();
                this.createQuizCards();
                this.createDots();
                this.bindEvents();

                // Initialize with first card
                if (this.latestQuizzes.length > 0) {
                    this.scrollToCard(0);
                }
            }

            createQuizCards() {
                if (!this.carouselTrack) return;

                this.carouselTrack.innerHTML = '';

                this.latestQuizzes.forEach((quiz, index) => {
                    const card = document.createElement('div');
                    card.className = 'explore-quiz-card-horizontal';
                    card.setAttribute('data-index', index);
                    card.setAttribute('data-quiz-id', quiz.id);

                    card.innerHTML = `
                        <div class="explore-quiz-card-horizontal-header">
                            <div class="explore-quiz-card-horizontal-icon">${quiz.icon}</div>
                            <div class="explore-quiz-card-horizontal-badge">M·ªõi</div>
                        </div>
                        <div class="explore-quiz-card-horizontal-content">
                            <h3 class="explore-quiz-card-horizontal-title">${quiz.name}</h3>
                            <p class="explore-quiz-card-horizontal-description">${quiz.subject}</p>
                            <div class="explore-quiz-card-horizontal-meta">
                                <span class="explore-quiz-meta-item-horizontal">üìä ${quiz.questions} c√¢u</span>
                                <span class="explore-quiz-meta-item-horizontal">üë§ ${quiz.author}</span>
                                <span class="explore-quiz-meta-item-horizontal">üëÅÔ∏è ${quiz.views || 0} l∆∞·ª£t xem</span>
                                <span class="explore-quiz-meta-item-horizontal">üî• ${quiz.attempts || 0} l∆∞·ª£t l√†m</span>
                            </div>
                            <button class="explore-quiz-start-btn-horizontal" 
                                    data-quiz-id="${quiz.id}"
                                    onclick="if(window.exploreQuizManager && window.exploreQuizManager.startPracticeMode) { window.exploreQuizManager.startPracticeMode('${quiz.id}'); } else { console.error('exploreQuizManager not ready'); }">
                                <i class="fas fa-play"></i>
                                V√†o √¥n thi
                            </button>
                        </div>
                    `;

                    this.carouselTrack.appendChild(card);
                });
            }

            createDots() {
                // Dots disabled - info section is hidden
                return;
            }

            bindEvents() {
                this.cards = document.querySelectorAll(".explore-quiz-card-horizontal");
                // this.dots = document.querySelectorAll(".explore-dot-horizontal"); // Disabled
                this.leftArrows = document.querySelectorAll(".explore-nav-arrow.left");
                this.rightArrows = document.querySelectorAll(".explore-nav-arrow.right");

                if (!this.cards.length) return;

                // Arrow buttons
                this.leftArrows.forEach(arrow => {
                    arrow.addEventListener("click", () => {
                        this.navigate(-1);
                    });
                });

                this.rightArrows.forEach(arrow => {
                    arrow.addEventListener("click", () => {
                        this.navigate(1);
                    });
                });

                // Dots - Disabled
                // this.dots.forEach((dot, i) => {
                //     dot.addEventListener("click", () => {
                //         this.scrollToCard(i);
                //     });
                // });

                // Cards
                this.cards.forEach((card, i) => {
                    card.addEventListener("click", () => {
                        this.scrollToCard(i);
                    });
                });
            }

            navigate(direction) {
                const newIndex = Math.max(0, Math.min(this.currentIndex + direction, this.latestQuizzes.length - 1));
                this.scrollToCard(newIndex);
            }

            scrollToCard(index) {
                if (!this.cards.length || index < 0 || index >= this.cards.length) return;

                this.currentIndex = index;
                const targetCard = this.cards[index];

                // Scroll to the card
                targetCard.scrollIntoView({
                    behavior: 'smooth',
                    block: 'nearest',
                    inline: 'center'
                });

                // Update dots (only if dots exist)
                if (this.dots && this.dots.length > 0) {
                    this.dots.forEach((dot, i) => {
                        dot.classList.toggle("active", i === index);
                    });
                }

                // Info section is hidden - no need to update
                // if (this.quizName && this.quizSubject && this.latestQuizzes[index]) {
                //     this.quizName.textContent = this.latestQuizzes[index].name;
                //     this.quizSubject.textContent = this.latestQuizzes[index].subject;
                // }
            }

            updateCarousel(newIndex) {
                // For backward compatibility
                this.scrollToCard(newIndex);
            }

            startQuiz(quizId) {
                // Deprecated - now using onclick with exploreQuizManager.startPracticeMode directly
                console.log('üåê startQuiz called (deprecated), redirecting to exploreQuizManager');
                if (window.exploreQuizManager && typeof window.exploreQuizManager.startPracticeMode === 'function') {
                    window.exploreQuizManager.startPracticeMode(quizId);
                } else {
                    console.error('‚ùå exploreQuizManager not available');
                }
            }

            showQuizModal(quiz) {
                const modal = document.createElement('div');
                modal.className = 'quiz-modal-overlay';
                modal.innerHTML = `
                    <div class="quiz-modal">
                        <div class="quiz-modal-header">
                            <h3>üéØ ${quiz.name}</h3>
                            <button class="quiz-modal-close" onclick="this.closest('.quiz-modal-overlay').remove()">√ó</button>
                        </div>
                        <div class="quiz-modal-body">
                            <p><strong>M√¥ t·∫£:</strong> ${quiz.subject}</p>
                            <p><strong>S·ªë c√¢u h·ªèi:</strong> ${quiz.questions} c√¢u</p>
                            <p><strong>T√°c gi·∫£:</strong> ${quiz.author}</p>
                            <p><strong>Ng√†y t·∫°o:</strong> ${quiz.date}</p>
                        </div>
                        <div class="quiz-modal-footer">
                            <button class="btn-primary" onclick="alert('üéØ Ch·ª©c nƒÉng l√†m b√†i ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn!'); this.closest('.quiz-modal-overlay').remove();">
                                <i class="fas fa-play"></i> V√†o l√†m b√†i
                            </button>
                            <button class="btn-secondary" onclick="this.closest('.quiz-modal-overlay').remove();">
                                <i class="fas fa-times"></i> ƒê√≥ng
                            </button>
                        </div>
                    </div>
                `;

                // Add modal styles
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                `;

                const modalContent = modal.querySelector('.quiz-modal');
                modalContent.style.cssText = `
                    background: white;
                    border-radius: 16px;
                    padding: 24px;
                    max-width: 500px;
                    width: 90%;
                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                `;

                document.body.appendChild(modal);
            }

            // Method to refresh carousel when new quizzes are loaded
            refresh() {
                console.log('üîÑ Refreshing explore carousel...');
                this.debugExploreQuizManager();
                this.loadLatestQuizzes();
            }

            // Debug method to check exploreQuizManager status
            debugExploreQuizManager() {
                console.log('üîç Debug exploreQuizManager:');
                if (window.exploreQuizManager) {
                    console.log('‚úÖ exploreQuizManager exists');
                    console.log('üìã Properties:', Object.keys(window.exploreQuizManager));

                    const possibleSources = ['sharedQuizzes', 'quizzes', 'allQuizzes', 'communityQuizzes', 'latestQuizzes', 'trendingQuizzes'];
                    possibleSources.forEach(source => {
                        if (window.exploreQuizManager[source]) {
                            console.log(`üìä ${source}:`, window.exploreQuizManager[source].length, 'items');
                        } else {
                            console.log(`‚ùå ${source}: not found`);
                        }
                    });
                } else {
                    console.log('‚ùå exploreQuizManager not found');
                }
            }

            // Helper method to extract data from trending section
            extractFromTrendingSection() {
                const trendingCards = document.querySelectorAll('.trending-quiz-card');
                if (trendingCards.length === 0) return [];

                console.log(`üåê Found ${trendingCards.length} trending quiz cards`);

                return Array.from(trendingCards).slice(0, 10).map((card, index) => {
                    const title = card.querySelector('.trending-quiz-title, h3, .quiz-title')?.textContent?.trim() || `Quiz ${index + 1}`;
                    const description = card.querySelector('.trending-quiz-description, p, .quiz-description')?.textContent?.trim() || 'Kh√¥ng c√≥ m√¥ t·∫£';
                    const questionText = card.querySelector('.trending-quiz-questions, .quiz-questions')?.textContent || '0';
                    const questionCount = questionText.match(/\d+/)?.[0] || '0';

                    // Try to get quiz ID from onclick or data attributes
                    const quizId = card.getAttribute('data-quiz-id') ||
                        card.querySelector('[data-quiz-id]')?.getAttribute('data-quiz-id') ||
                        card.getAttribute('onclick')?.match(/['"]([^'"]+)['"]/)?.[1] ||
                        `trending-${index}`;

                    return {
                        id: quizId,
                        title: title,
                        name: title,
                        description: description,
                        subject: description,
                        questions: parseInt(questionCount) || 0,
                        questionCount: parseInt(questionCount) || 0,
                        date: new Date().toLocaleDateString('vi-VN'),
                        author: 'C·ªông ƒë·ªìng',
                        createdAt: new Date().toISOString()
                    };
                });
            }

            // Helper method to extract data from any quiz cards in DOM
            extractFromDOM() {
                const allCards = document.querySelectorAll('.quiz-card-horizontal, .quiz-card, .trending-quiz-card');
                if (allCards.length === 0) return [];

                console.log(`üåê Found ${allCards.length} quiz cards in DOM`);

                return Array.from(allCards).slice(0, 10).map((card, index) => {
                    const title = card.querySelector('h3, .quiz-title, .trending-quiz-title')?.textContent?.trim() || `Quiz ${index + 1}`;
                    const description = card.querySelector('p, .quiz-description, .trending-quiz-description')?.textContent?.trim() || 'Kh√¥ng c√≥ m√¥ t·∫£';
                    const questionText = card.querySelector('.quiz-questions, .trending-quiz-questions')?.textContent || '0';
                    const questionCount = questionText.match(/\d+/)?.[0] || '0';

                    // Try to get quiz ID from various sources
                    const quizId = card.getAttribute('data-quiz-id') ||
                        card.querySelector('[data-quiz-id]')?.getAttribute('data-quiz-id') ||
                        card.getAttribute('onclick')?.match(/['"]([^'"]+)['"]/)?.[1] ||
                        `dom-${index}`;

                    return {
                        id: quizId,
                        title: title,
                        name: title,
                        description: description,
                        subject: description,
                        questions: parseInt(questionCount) || 0,
                        questionCount: parseInt(questionCount) || 0,
                        date: new Date().toLocaleDateString('vi-VN'),
                        author: 'C·ªông ƒë·ªìng',
                        createdAt: new Date().toISOString()
                    };
                });
            }
        }

        // Initialize explore carousel when DOM is ready
        let latestQuizCarousel3D;
        document.addEventListener('DOMContentLoaded', function () {
            setTimeout(() => {
                latestQuizCarousel3D = new ExploreQuizCarousel3D();
                console.log('üåê Explore Quiz Carousel 3D initialized');

                // Make it globally accessible
                window.latestQuizCarousel3D = latestQuizCarousel3D;

                // Add global debug function
                window.debugExploreCarousel = () => {
                    if (latestQuizCarousel3D) {
                        latestQuizCarousel3D.debugExploreQuizManager();
                        latestQuizCarousel3D.refresh();
                    }
                };

                // Listen for explore tab activation to refresh carousel
                const exploreTab = document.querySelector('[data-tab="explore"]');
                if (exploreTab) {
                    exploreTab.addEventListener('click', () => {
                        console.log('üì¢ Explore tab clicked - refreshing carousel');

                        // Try multiple times with increasing delays
                        const tryRefresh = (attempt = 1, maxAttempts = 5) => {
                            setTimeout(() => {
                                if (latestQuizCarousel3D) {
                                    console.log(`üîÑ Refresh attempt ${attempt}/${maxAttempts}`);
                                    latestQuizCarousel3D.refresh();

                                    // If still no data and more attempts left, try again
                                    if (latestQuizCarousel3D.latestQuizzes.length === 0 && attempt < maxAttempts) {
                                        tryRefresh(attempt + 1, maxAttempts);
                                    }
                                }
                            }, attempt * 500); // Increasing delay: 500ms, 1s, 1.5s, 2s, 2.5s
                        };

                        tryRefresh();
                    });
                }

                // Listen for exploreQuizManager updates
                if (window.exploreQuizManager) {
                    // Hook into exploreQuizManager's loadSharedQuizzes method
                    const originalLoadSharedQuizzes = window.exploreQuizManager.loadSharedQuizzes;
                    if (originalLoadSharedQuizzes) {
                        window.exploreQuizManager.loadSharedQuizzes = function (...args) {
                            const result = originalLoadSharedQuizzes.apply(this, args);

                            // Refresh carousel after loading
                            setTimeout(() => {
                                if (latestQuizCarousel3D) {
                                    latestQuizCarousel3D.refresh();
                                }
                            }, 1000);

                            return result;
                        };
                    }
                }

            }, 200);
        });
    </script>

    <!-- üéØ ADAPTIVE EXPLORE LAYOUT SYSTEM CSS -->
    <style>
        /* üéØ DEVICE DETECTION & ADAPTIVE VARIABLES */
        :root {
            --adaptive-primary: #667eea;
            --adaptive-secondary: #764ba2;
            --adaptive-success: #48bb78;
            --adaptive-warning: #ed8936;
            --adaptive-danger: #f56565;
            --adaptive-info: #4299e1;

            --adaptive-bg-primary: #ffffff;
            --adaptive-bg-secondary: #f7fafc;
            --adaptive-bg-tertiary: #edf2f7;

            --adaptive-text-primary: #2d3748;
            --adaptive-text-secondary: #4a5568;
            --adaptive-text-muted: #718096;

            --adaptive-border: #e2e8f0;
            --adaptive-border-light: #f1f5f9;

            --adaptive-shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.06);
            --adaptive-shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
            --adaptive-shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.12);

            --adaptive-radius-sm: 8px;
            --adaptive-radius-md: 12px;
            --adaptive-radius-lg: 16px;

            --adaptive-spacing-xs: 8px;
            --adaptive-spacing-sm: 12px;
            --adaptive-spacing-md: 16px;
            --adaptive-spacing-lg: 24px;
            --adaptive-spacing-xl: 32px;
        }

        /* üéØ TOP SECTION ONLY - Ch·ªâ √°p d·ª•ng cho ph·∫ßn tr√™n */
        .explore-top-section {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto 24px auto;
            padding: 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            overflow: hidden;
            box-sizing: border-box;
            border-radius: 16px;
            contain: layout style;
        }

        /* üì± DEVICE-AWARE HEADER */
        .explore-header-adaptive {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding: 20px;
            background: linear-gradient(135deg, var(--adaptive-primary), var(--adaptive-secondary));
            border-radius: 12px;
            color: white;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .explore-title-section {
            display: flex;
            align-items: center;
            gap: var(--adaptive-spacing-md);
        }

        .explore-icon-wrapper {
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--adaptive-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .explore-title-content h2 {
            font-size: 28px;
            font-weight: 700;
            margin: 0 0 4px 0;
        }

        .explore-subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin: 0;
        }

        .explore-device-indicator {
            display: flex;
            align-items: center;
            gap: var(--adaptive-spacing-xs);
            background: rgba(255, 255, 255, 0.15);
            padding: var(--adaptive-spacing-xs) var(--adaptive-spacing-sm);
            border-radius: var(--adaptive-radius-sm);
            font-size: 12px;
            font-weight: 600;
        }

        /* üé® SMART CONTROL PANEL */
        .smart-control-panel {
            display: grid;
            gap: 16px;
            margin-bottom: 0;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            justify-items: center;
        }

        .control-card {
            background: var(--adaptive-bg-primary);
            border-radius: 12px;
            padding: 18px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--adaptive-border-light);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 16px;
            width: 100%;
            max-width: 320px;
            box-sizing: border-box;
            justify-self: center;
        }

        .control-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--adaptive-shadow-lg);
            border-color: var(--adaptive-primary);
        }

        .card-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--adaptive-primary), var(--adaptive-secondary));
            border-radius: var(--adaptive-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            flex-shrink: 0;
        }

        .card-content {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        .card-content label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--adaptive-text-primary);
            margin-bottom: var(--adaptive-spacing-xs);
        }

        .smart-input,
        .smart-select {
            width: 100%;
            max-width: 100%;
            padding: var(--adaptive-spacing-sm) var(--adaptive-spacing-md);
            border: 2px solid var(--adaptive-border);
            border-radius: var(--adaptive-radius-sm);
            background: var(--adaptive-bg-secondary);
            color: var(--adaptive-text-primary);
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-sizing: border-box;
            min-width: 0;
        }

        .smart-input:focus,
        .smart-select:focus {
            outline: none;
            border-color: var(--adaptive-primary);
            background: var(--adaptive-bg-primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .room-input-group {
            display: flex;
            gap: var(--adaptive-spacing-xs);
            align-items: center;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        .room-code {
            text-align: center;
            letter-spacing: 1px;
            font-weight: 600;
            max-width: 120px;
            min-width: 0;
            flex: 1;
        }

        .smart-btn {
            padding: var(--adaptive-spacing-sm) var(--adaptive-spacing-md);
            border: none;
            border-radius: var(--adaptive-radius-sm);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--adaptive-spacing-xs);
        }

        .smart-btn.primary {
            background: linear-gradient(135deg, var(--adaptive-primary), var(--adaptive-secondary));
            color: white;
            width: 40px;
            height: 40px;
        }

        .smart-btn.secondary {
            background: var(--adaptive-bg-tertiary);
            color: var(--adaptive-text-primary);
            border: 1px solid var(--adaptive-border);
        }

        .smart-btn.warning {
            background: linear-gradient(135deg, #f6ad55, #ed8936);
            color: white;
            border: 1px solid #ed8936;
        }

        .smart-btn.full-width {
            width: 100%;
        }

        .smart-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--adaptive-shadow-md);
        }

        .smart-btn.primary:hover {
            background: linear-gradient(135deg, #5a67d8, #6b46c1);
        }

        .smart-btn.secondary:hover {
            background: var(--adaptive-bg-primary);
            border-color: var(--adaptive-primary);
        }

        .smart-btn.warning:hover {
            background: linear-gradient(135deg, #ed8936, #dd6b20);
            border-color: #dd6b20;
        }

        .filter-result {
            font-size: 12px;
            color: var(--adaptive-text-muted);
            margin-top: var(--adaptive-spacing-xs);
            font-weight: 500;
        }

        /* üéØ ADAPTIVE QUIZ DISPLAY AREA */
        .adaptive-quiz-display {
            background: var(--adaptive-bg-primary);
            border-radius: var(--adaptive-radius-lg);
            box-shadow: var(--adaptive-shadow-md);
            overflow: hidden;
        }

        .adaptive-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--adaptive-spacing-xl);
            gap: var(--adaptive-spacing-md);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--adaptive-border);
            border-top: 3px solid var(--adaptive-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-text {
            color: var(--adaptive-text-muted);
            font-weight: 500;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* üéØ QUIZ SECTIONS */
        .quiz-sections-container {
            display: flex;
            flex-direction: column;
            gap: var(--adaptive-spacing-xl);
        }

        .adaptive-quiz-section {
            padding: var(--adaptive-spacing-lg);
        }

        .section-header-adaptive {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--adaptive-spacing-lg);
            padding-bottom: var(--adaptive-spacing-md);
            border-bottom: 2px solid var(--adaptive-border-light);
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: var(--adaptive-spacing-sm);
        }

        .section-title i {
            font-size: 20px;
            color: var(--adaptive-primary);
        }

        .section-title h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--adaptive-text-primary);
            margin: 0;
        }

        .section-action-btn {
            background: transparent;
            border: 2px solid var(--adaptive-border);
            color: var(--adaptive-text-secondary);
            padding: var(--adaptive-spacing-xs) var(--adaptive-spacing-md);
            border-radius: var(--adaptive-radius-sm);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: var(--adaptive-spacing-xs);
        }

        .section-action-btn:hover {
            background: var(--adaptive-primary);
            color: white;
            border-color: var(--adaptive-primary);
            transform: translateY(-1px);
        }

        .adaptive-quiz-container {
            background: var(--adaptive-bg-secondary);
            border-radius: var(--adaptive-radius-md);
            padding: var(--adaptive-spacing-md);
        }

        .quiz-scroll-area {
            display: flex;
            gap: var(--adaptive-spacing-lg);
            overflow-x: auto;
            overflow-y: hidden;
            padding: var(--adaptive-spacing-md);
            scroll-behavior: smooth;
            scrollbar-width: thin;
        }

        .quiz-scroll-area::-webkit-scrollbar {
            height: 6px;
        }

        .quiz-scroll-area::-webkit-scrollbar-track {
            background: var(--adaptive-border-light);
            border-radius: 3px;
        }

        .quiz-scroll-area::-webkit-scrollbar-thumb {
            background: var(--adaptive-primary);
            border-radius: 3px;
        }

        .quiz-loading-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--adaptive-spacing-sm);
            padding: var(--adaptive-spacing-xl);
            color: var(--adaptive-text-muted);
            font-weight: 500;
            min-width: 200px;
        }

        /* üì± RESPONSIVE BREAKPOINTS */

        /* Large Desktop (1200px+) */
        @media (min-width: 1200px) {
            .smart-control-panel {
                grid-template-columns: repeat(4, 1fr);
                max-width: 1200px;
                margin: 0 auto;
            }

            .explore-top-section {
                padding: 24px;
                max-width: 1200px;
            }
        }

        /* Desktop (992px - 1199px) */
        @media (max-width: 1199px) and (min-width: 992px) {
            .smart-control-panel {
                grid-template-columns: repeat(3, 1fr);
                max-width: 960px;
                margin: 0 auto;
            }

            .explore-top-section {
                max-width: 960px;
                padding: 20px;
            }
        }

        /* Tablet (768px - 991px) */
        @media (max-width: 991px) and (min-width: 768px) {
            .smart-control-panel {
                grid-template-columns: repeat(2, 1fr);
                max-width: 720px;
                margin: 0 auto;
            }

            .explore-top-section {
                max-width: 720px;
                padding: 16px;
            }

            .explore-header-adaptive {
                flex-direction: column;
                gap: 16px;
                text-align: center;
                padding: 16px;
            }

            .explore-title-content h2 {
                font-size: 24px;
            }
        }

        /* Mobile Large (576px - 767px) */
        @media (max-width: 767px) and (min-width: 576px) {
            .smart-control-panel {
                grid-template-columns: 1fr;
                gap: 12px;
                max-width: 540px;
                margin: 0 auto;
            }

            .explore-top-section {
                padding: 16px;
                max-width: 100%;
                margin: 0 auto 20px auto;
            }

            .explore-header-adaptive {
                flex-direction: column;
                gap: 12px;
                text-align: center;
                padding: 16px;
            }

            .explore-title-content h2 {
                font-size: 22px;
            }

            .control-card {
                flex-direction: column;
                text-align: center;
                gap: 12px;
                padding: 16px;
                max-width: 100%;
            }

            .room-input-group {
                flex-direction: column;
                gap: 8px;
                width: 100%;
            }

            .room-code {
                max-width: 100%;
                width: 100%;
            }

            .smart-btn.primary {
                width: 100%;
                height: 40px;
            }
        }

        /* Mobile Small (320px - 575px) */
        @media (max-width: 575px) {
            .explore-top-section {
                padding: 12px;
                max-width: 100%;
                margin: 0 auto 16px auto;
            }

            .explore-header-adaptive {
                padding: 12px;
                flex-direction: column;
                gap: 8px;
                text-align: center;
            }

            .explore-title-content h2 {
                font-size: 20px;
            }

            .explore-subtitle {
                font-size: 12px;
            }

            .smart-control-panel {
                grid-template-columns: 1fr;
                gap: 8px;
                max-width: 100%;
            }

            .control-card {
                padding: 12px;
                flex-direction: column;
                text-align: center;
                gap: 8px;
                max-width: 100%;
            }

            .card-icon {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }

            .room-input-group {
                flex-direction: column;
                gap: 8px;
                width: 100%;
            }

            .room-code {
                max-width: 100%;
                width: 100%;
            }

            .smart-btn.primary {
                width: 100%;
                height: 40px;
            }

            .section-header-adaptive {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }

            .section-title h3 {
                font-size: 18px;
            }
        }

        /* üéØ DEVICE-SPECIFIC OPTIMIZATIONS */

        /* MINIMAL: Prevent horizontal overflow on all devices */
        #explore-tab {
            overflow-x: hidden;
        }

        #explore-tab * {
            box-sizing: border-box;
        }

        /* Ensure main content area doesn't overflow */
        .main-content-area {
            overflow-x: hidden;
        }

        /* Specific for explore tab only */
        #explore-tab.tab-content {
            padding: 20px;
        }

        /* üéØ MINIMAL CENTER ALIGNMENT */
        .explore-top-section {
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* MINIMAL: Force center for main wrapper */
        .main-wrapper {
            overflow-x: hidden;
        }

        .app-layout {
            overflow-x: hidden;
        }

        /* üéØ ENSURE QUIZ DISPLAY AREA IS SEPARATE */
        .shared-quizzes-section {
            margin-top: 0 !important;
            padding-top: 0 !important;
            clear: both;
            width: 100%;
            max-width: 100%;
            overflow: hidden;
        }

        /* üîß MINIMAL EXPLORE TAB LAYOUT */
        #explore-tab .explore-top-section {
            max-width: 1200px;
            margin: 0 auto 24px auto;
        }

        #explore-tab .shared-quizzes-section {
            margin-top: 0;
        }

        /* üîß KH√îI PH·ª§C QUIZ CARDS G·ªêC - Giao di·ªán g·ªëc cho quiz c·ªßa ng∆∞·ªùi d√πng */
        .quiz-list {
            display: grid;
            gap: 25px;
        }

        .quiz-item {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.03), rgba(118, 75, 162, 0.03));
            border: 2px solid var(--border-color, #e1e5f2);
            border-radius: 16px;
            padding: 25px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .quiz-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transform: scaleY(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .quiz-item:hover {
            border-color: var(--primary-color, #667eea);
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.2);
        }

        .quiz-item:hover::before {
            transform: scaleY(1);
        }

        .quiz-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 20px;
        }

        .quiz-item-info {
            flex: 1;
        }

        .quiz-item-info h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary, #333);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quiz-item-info h3::before {
            content: 'üìù';
            font-size: 24px;
        }

        .quiz-item-info p {
            color: var(--text-secondary, #666);
            font-size: 15px;
            margin-bottom: 12px;
            line-height: 1.6;
        }

        .quiz-item-meta {
            display: flex;
            gap: 20px;
            font-size: 13px;
            color: var(--text-secondary, #666);
            flex-wrap: wrap;
        }

        .quiz-item-meta span {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
        }

        .quiz-item-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* ƒê·∫£m b·∫£o quiz cards hi·ªÉn th·ªã ƒë√∫ng trong t·∫•t c·∫£ tabs */
        #home-tab .quiz-item,
        #manage-tab .quiz-item,
        .quiz-manage-list .quiz-item {
            display: block;
            visibility: visible;
            opacity: 1;
        }

        /* Empty State */
        .empty-state,
        .quiz-placeholder,
        .results-placeholder {
            text-align: center;
            padding: 80px 30px;
            color: var(--text-secondary, #666);
        }

        .empty-state i,
        .quiz-placeholder i,
        .results-placeholder i {
            font-size: 64px;
            color: var(--border-color, #e1e5f2);
            margin-bottom: 25px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .empty-state h3,
        .quiz-placeholder h3,
        .results-placeholder h3 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text-primary, #333);
        }

        .empty-state p,
        .quiz-placeholder p,
        .results-placeholder p {
            font-size: 16px;
            opacity: 0.8;
        }

        /* Touch Device Optimizations */
        @media (hover: none) and (pointer: coarse) {

            .smart-btn,
            .section-action-btn {
                min-height: 44px;
                min-width: 44px;
            }

            .smart-input,
            .smart-select {
                min-height: 44px;
            }

            .control-card:hover {
                transform: none;
            }
        }

        /* High DPI Display Optimizations */
        @media (-webkit-min-device-pixel-ratio: 2),
        (min-resolution: 192dpi) {

            .explore-icon-wrapper,
            .card-icon {
                border: 0.5px solid rgba(255, 255, 255, 0.1);
            }
        }

        /* Dark Mode Support */
        @media (prefers-color-scheme: dark) {
            :root {
                --adaptive-bg-primary: #1a202c;
                --adaptive-bg-secondary: #2d3748;
                --adaptive-bg-tertiary: #4a5568;
                --adaptive-text-primary: #f7fafc;
                --adaptive-text-secondary: #e2e8f0;
                --adaptive-text-muted: #a0aec0;
                --adaptive-border: #4a5568;
                --adaptive-border-light: #2d3748;
            }
        }

        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {

            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* üîß GLOBAL LAYOUT FIX - NgƒÉn ch·∫∑n overflow v√† l·ªách layout */
        * {
            box-sizing: border-box;
        }

        html,
        body {
            width: 100%;
            max-width: 100vw;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }

        .tab-content {
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
            box-sizing: border-box;
        }

        /* üè† CSS CH·ªà CHO TRANG CH·ª¶ - KH√îNG ·∫¢NH H∆Ø·ªûNG TAB EXPLORE */
        #home-tab .quiz-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }

        #home-tab .quiz-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.03), rgba(118, 75, 162, 0.03));
            border: 2px solid #e1e5f2;
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 300px;
        }

        #home-tab .quiz-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transform: scaleY(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #home-tab .quiz-card:hover {
            border-color: #667eea;
            transform: translateY(-8px);
            box-shadow: 0 16px 40px rgba(102, 126, 234, 0.2);
        }

        #home-tab .quiz-card:hover::before {
            transform: scaleY(1);
        }

        #home-tab .quiz-card-header {
            flex: 1;
            margin-bottom: 20px;
        }

        #home-tab .quiz-card-title {
            font-size: 20px;
            font-weight: 700;
            color: #333;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            line-height: 1.3;
        }

        #home-tab .quiz-card-title::before {
            content: 'üìù';
            font-size: 24px;
            flex-shrink: 0;
        }

        #home-tab .quiz-card-description {
            color: #666;
            font-size: 15px;
            line-height: 1.6;
            margin-bottom: 16px;
            min-height: 48px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        #home-tab .quiz-card-meta {
            display: flex;
            gap: 16px;
            font-size: 13px;
            color: #666;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        #home-tab .quiz-card-meta span {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
            font-weight: 500;
        }

        #home-tab .quiz-card-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: auto;
            padding-top: 16px;
            border-top: 1px solid rgba(102, 126, 234, 0.1);
        }

        #home-tab .quiz-card-actions .btn {
            padding: 10px 16px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            text-decoration: none;
            flex: 1;
            justify-content: center;
            min-width: 80px;
        }

        #home-tab .quiz-card-actions .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        #home-tab .quiz-card-actions .btn-primary:hover {
            background: linear-gradient(135deg, #5a67d8, #6b46c1);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        #home-tab .quiz-card-actions .btn-secondary {
            background: #f7fafc;
            color: #4a5568;
            border: 1px solid #e2e8f0;
        }

        #home-tab .quiz-card-actions .btn-secondary:hover {
            background: #edf2f7;
            border-color: #cbd5e0;
            transform: translateY(-1px);
        }

        #home-tab .quiz-card-actions .btn-share-quiz {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            box-shadow: 0 4px 12px rgba(72, 187, 120, 0.3);
        }

        #home-tab .quiz-card-actions .btn-share-quiz:hover {
            background: linear-gradient(135deg, #38a169, #2f855a);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(72, 187, 120, 0.4);
        }

        /* Responsive ch·ªâ cho home tab */
        @media (max-width: 768px) {
            #home-tab .quiz-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            #home-tab .quiz-card {
                padding: 20px;
                min-height: 260px;
            }

            #home-tab .quiz-card-actions {
                flex-direction: column;
            }

            #home-tab .quiz-card-actions .btn {
                flex: none;
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            #home-tab .quiz-card {
                padding: 16px;
                min-height: 240px;
            }

            #home-tab .quiz-card-title {
                font-size: 18px;
            }

            #home-tab .quiz-card-description {
                font-size: 14px;
                min-height: 42px;
            }
        }
    </style>

    <!-- üéØ DEVICE DETECTION & ADAPTIVE LAYOUT JAVASCRIPT -->
    <script>
        // üéØ Advanced Device Detection System
        class DeviceDetector {
            constructor() {
                this.deviceInfo = this.detectDevice();
                this.init();
            }

            detectDevice() {
                const userAgent = navigator.userAgent;
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                const pixelRatio = window.devicePixelRatio || 1;
                const touchSupport = 'ontouchstart' in window;

                // Device type detection
                let deviceType = 'desktop';
                let deviceSize = 'large';
                let deviceIcon = 'fas fa-desktop';

                if (screenWidth <= 575) {
                    deviceType = 'mobile';
                    deviceSize = 'small';
                    deviceIcon = 'fas fa-mobile-alt';
                } else if (screenWidth <= 767) {
                    deviceType = 'mobile';
                    deviceSize = 'medium';
                    deviceIcon = 'fas fa-mobile-alt';
                } else if (screenWidth <= 991) {
                    deviceType = 'tablet';
                    deviceSize = 'medium';
                    deviceIcon = 'fas fa-tablet-alt';
                } else if (screenWidth <= 1199) {
                    deviceType = 'desktop';
                    deviceSize = 'medium';
                    deviceIcon = 'fas fa-laptop';
                } else {
                    deviceType = 'desktop';
                    deviceSize = 'large';
                    deviceIcon = 'fas fa-desktop';
                }

                // OS Detection
                let os = 'unknown';
                if (userAgent.includes('Windows')) os = 'windows';
                else if (userAgent.includes('Mac')) os = 'macos';
                else if (userAgent.includes('Linux')) os = 'linux';
                else if (userAgent.includes('Android')) os = 'android';
                else if (userAgent.includes('iOS') || userAgent.includes('iPhone') || userAgent.includes('iPad')) os = 'ios';

                // Browser Detection
                let browser = 'unknown';
                if (userAgent.includes('Chrome')) browser = 'chrome';
                else if (userAgent.includes('Firefox')) browser = 'firefox';
                else if (userAgent.includes('Safari')) browser = 'safari';
                else if (userAgent.includes('Edge')) browser = 'edge';

                return {
                    type: deviceType,
                    size: deviceSize,
                    icon: deviceIcon,
                    width: screenWidth,
                    height: screenHeight,
                    pixelRatio: pixelRatio,
                    touchSupport: touchSupport,
                    os: os,
                    browser: browser,
                    isHighDPI: pixelRatio > 1.5,
                    isRetina: pixelRatio >= 2,
                    orientation: screenWidth > screenHeight ? 'landscape' : 'portrait'
                };
            }

            init() {
                this.updateDeviceIndicator();
                this.applyDeviceOptimizations();
                this.setupEventListeners();

                console.log('üéØ Device Detection:', this.deviceInfo);
            }

            updateDeviceIndicator() {
                const indicator = document.getElementById('device-indicator');
                if (indicator) {
                    const deviceName = `${this.deviceInfo.type.charAt(0).toUpperCase() + this.deviceInfo.type.slice(1)} (${this.deviceInfo.width}x${this.deviceInfo.height})`;

                    indicator.innerHTML = `
                        <i class="${this.deviceInfo.icon}"></i>
                        <span>${deviceName}</span>
                    `;
                }
            }

            applyDeviceOptimizations() {
                const container = document.getElementById('explore-adaptive-container');
                if (!container) return;

                // Add device-specific classes
                container.classList.add(`device-${this.deviceInfo.type}`);
                container.classList.add(`device-${this.deviceInfo.size}`);
                container.classList.add(`os-${this.deviceInfo.os}`);

                if (this.deviceInfo.touchSupport) {
                    container.classList.add('touch-device');
                }

                if (this.deviceInfo.isHighDPI) {
                    container.classList.add('high-dpi');
                }

                // Apply layout optimizations
                this.optimizeControlPanel();
                this.optimizeQuizDisplay();
            }

            optimizeControlPanel() {
                const panel = document.getElementById('smart-control-panel');
                if (!panel) return;

                // Adjust grid based on device
                let columns;
                switch (this.deviceInfo.type) {
                    case 'mobile':
                        columns = '1fr';
                        break;
                    case 'tablet':
                        columns = 'repeat(2, 1fr)';
                        break;
                    case 'desktop':
                        columns = this.deviceInfo.size === 'large'
                            ? 'repeat(4, 1fr)'
                            : 'repeat(3, 1fr)';
                        break;
                    default:
                        columns = 'repeat(auto-fit, minmax(280px, 1fr))';
                }

                panel.style.gridTemplateColumns = columns;
            }

            optimizeQuizDisplay() {
                const display = document.getElementById('adaptive-quiz-display');
                if (!display) return;

                // Adjust quiz card sizes based on device
                const cards = display.querySelectorAll('.quiz-card-horizontal');
                cards.forEach(card => {
                    if (this.deviceInfo.type === 'mobile') {
                        card.style.minWidth = this.deviceInfo.size === 'small' ? '260px' : '280px';
                        card.style.maxWidth = this.deviceInfo.size === 'small' ? '260px' : '280px';
                    } else if (this.deviceInfo.type === 'tablet') {
                        card.style.minWidth = '320px';
                        card.style.maxWidth = '320px';
                    } else {
                        card.style.minWidth = '340px';
                        card.style.maxWidth = '340px';
                    }
                });
            }

            setupEventListeners() {
                // Handle orientation change
                window.addEventListener('orientationchange', () => {
                    setTimeout(() => {
                        this.deviceInfo = this.detectDevice();
                        this.updateDeviceIndicator();
                        this.applyDeviceOptimizations();
                    }, 100);
                });

                // Handle resize with debounce
                let resizeTimeout;
                window.addEventListener('resize', () => {
                    clearTimeout(resizeTimeout);
                    resizeTimeout = setTimeout(() => {
                        this.deviceInfo = this.detectDevice();
                        this.updateDeviceIndicator();
                        this.applyDeviceOptimizations();
                    }, 250);
                });
            }
        }

        // üéØ Smart Input Handlers
        class SmartInputHandlers {
            constructor() {
                this.init();
            }

            init() {
                this.setupRoomCodeInput();
                this.setupCategoryFilter();
                this.setupRefreshButton();
            }

            setupRoomCodeInput() {
                const input = document.getElementById('join-room-code-input');
                const button = document.getElementById('btn-join-room');

                if (!input || !button) return;

                // Input validation
                input.addEventListener('input', (e) => {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length > 6) value = value.substring(0, 6);
                    e.target.value = value;

                    // Visual feedback
                    if (value.length === 6) {
                        input.style.borderColor = 'var(--adaptive-success)';
                        button.style.background = 'linear-gradient(135deg, var(--adaptive-success), #38a169)';
                    } else if (value.length > 0) {
                        input.style.borderColor = 'var(--adaptive-warning)';
                        button.style.background = 'linear-gradient(135deg, var(--adaptive-warning), #dd6b20)';
                    } else {
                        input.style.borderColor = 'var(--adaptive-border)';
                        button.style.background = 'linear-gradient(135deg, var(--adaptive-primary), var(--adaptive-secondary))';
                    }
                });

                // Enter key support
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && e.target.value.length === 6) {
                        this.joinRoom();
                    }
                });

                // Button click
                button.addEventListener('click', () => {
                    if (input.value.length === 6) {
                        this.joinRoom();
                    } else {
                        this.shakeElement(input.closest('.control-card'));
                        input.focus();
                    }
                });
            }

            setupCategoryFilter() {
                const select = document.getElementById('category-filter-select');
                const result = document.getElementById('filter-result-text');

                if (!select || !result) return;

                select.addEventListener('change', (e) => {
                    const value = e.target.value;
                    const text = e.target.options[e.target.selectedIndex].text;

                    if (value === 'all') {
                        result.textContent = 'Hi·ªÉn th·ªã t·∫•t c·∫£ t√†i li·ªáu';
                    } else {
                        result.textContent = `L·ªçc theo: ${text}`;
                    }

                    // Trigger filter (if exploreQuizManager exists)
                    if (window.exploreQuizManager && window.exploreQuizManager.filterByCategory) {
                        window.exploreQuizManager.filterByCategory(value);
                    }
                });
            }

            setupRefreshButton() {
                const button = document.getElementById('refresh-shared-quizzes');
                if (!button) return;

                button.addEventListener('click', () => {
                    // Add loading state
                    const originalHTML = button.innerHTML;
                    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>ƒêang t·∫£i...</span>';
                    button.disabled = true;

                    // Simulate refresh (replace with actual logic)
                    setTimeout(() => {
                        button.innerHTML = originalHTML;
                        button.disabled = false;

                        // Trigger refresh (if exploreQuizManager exists)
                        if (window.exploreQuizManager && window.exploreQuizManager.loadSharedQuizzes) {
                            window.exploreQuizManager.loadSharedQuizzes();
                        }
                    }, 1500);
                });
            }

            joinRoom() {
                const input = document.getElementById('join-room-code-input');
                const roomCode = input.value.trim();

                if (roomCode.length !== 6) {
                    alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë√∫ng 6 s·ªë!');
                    return;
                }

                // Show success feedback
                const card = input.closest('.control-card');
                const originalBg = card.style.background;
                card.style.background = 'linear-gradient(135deg, var(--adaptive-success), #38a169)';
                card.style.color = 'white';

                setTimeout(() => {
                    card.style.background = originalBg;
                    card.style.color = '';
                }, 2000);

                alert(`üéØ ƒêang v√†o ph√≤ng thi: ${roomCode}`);
                input.value = '';
            }

            shakeElement(element) {
                element.style.animation = 'shake 0.5s ease-in-out';
                setTimeout(() => {
                    element.style.animation = '';
                }, 500);
            }
        }

        // üéØ Initialize Adaptive System
        document.addEventListener('DOMContentLoaded', function () {
            console.log('üéØ Initializing Adaptive Explore Layout System...');

            // Initialize device detection
            window.deviceDetector = new DeviceDetector();

            // Initialize smart input handlers
            window.smartInputHandlers = new SmartInputHandlers();

            console.log('‚úÖ Adaptive Explore Layout System initialized');
        });

        // Add shake animation CSS
        const shakeCSS = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
        `;

        const style = document.createElement('style');
        style.textContent = shakeCSS;
        document.head.appendChild(style);

        // ========================================
        // BUBBLE NAVIGATION EFFECT
        // ========================================
        class BubbleNavigation {
            constructor() {
                this.navItems = document.querySelectorAll('.nav-item');
                this.activeBubble = document.querySelector('.bubble.active');
                this.hoverBubble = document.querySelector('.bubble.hover');
                this.currentActive = document.querySelector('.nav-item.active');
                this.supportsAnchor = CSS.supports('anchor-name', '--test');

                this.init();
            }

            init() {
                if (!this.activeBubble || !this.hoverBubble) return;

                this.setupEventListeners();
                this.updateBubblePosition();
            }

            setupEventListeners() {
                this.navItems.forEach(item => {
                    // Click event - integrate with existing tab system
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const tabName = item.dataset.tab;
                        if (tabName && window.quizManager) {
                            window.quizManager.switchTab(tabName);
                        } else {
                            this.setActiveItem(item);
                        }
                    });

                    // Hover events
                    item.addEventListener('mouseenter', () => {
                        this.showHoverBubble(item);
                    });

                    item.addEventListener('mouseleave', () => {
                        this.hideHoverBubble();
                    });
                });
            }

            setActiveItem(newActiveItem) {
                // Remove active class from current item
                this.currentActive?.classList.remove('active');

                // Add active class to new item
                newActiveItem.classList.add('active');
                this.currentActive = newActiveItem;

                // Update bubble position
                this.updateBubblePosition();
            }

            updateBubblePosition() {
                // CSS Anchor Positioning s·∫Ω t·ª± ƒë·ªông x·ª≠ l√Ω v·ªã tr√≠ bubble
                // Ch·ªâ c·∫ßn ƒë·∫£m b·∫£o anchor-name ƒë∆∞·ª£c set ƒë√∫ng
                if (!this.currentActive) return;

                // Force reflow ƒë·ªÉ CSS anchor positioning ho·∫°t ƒë·ªông
                this.activeBubble.offsetHeight;
            }

            showHoverBubble(item) {
                if (item === this.currentActive || !this.hoverBubble) return;

                // Set anchor name cho hover bubble
                item.style.anchorName = '--nav';
                this.hoverBubble.style.opacity = '1';
            }

            hideHoverBubble() {
                if (this.hoverBubble) {
                    this.hoverBubble.style.opacity = '0';
                }
            }
        }

        // Initialize bubble navigation
        window.bubbleNav = new BubbleNavigation();

        // Update bubble position on window resize
        window.addEventListener('resize', () => {
            if (window.bubbleNav) {
                window.bubbleNav.updateBubblePosition();
            }
        });
    </script>
</body>

</html>